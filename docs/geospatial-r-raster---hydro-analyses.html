<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 Geospatial R Raster - Hydro Analyses | Watershed Analysis: ENSC 445/LRES 545</title>
  <meta name="description" content="Chapter 16 Geospatial R Raster - Hydro Analyses | Watershed Analysis: ENSC 445/LRES 545" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 Geospatial R Raster - Hydro Analyses | Watershed Analysis: ENSC 445/LRES 545" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Geospatial R Raster - Hydro Analyses | Watershed Analysis: ENSC 445/LRES 545" />
  
  
  

<meta name="author" content="Tim Covino" />


<meta name="date" content="2024-04-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="for-loops.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<link href="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.css" rel="stylesheet" />
<script src="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Watershed Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-overview-and-objectives"><i class="fa fa-check"></i><b>1.1</b> Course overview and objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i><b>1.2</b> Structure</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#tentative-schedule-subject-to-change"><i class="fa fa-check"></i><b>1.3</b> Tentative schedule, subject to change</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html"><i class="fa fa-check"></i><b>2</b> Intro to data visualization</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#download-and-install-tidyverse-library"><i class="fa fa-check"></i><b>2.2</b> Download and install tidyverse library</a></li>
<li class="chapter" data-level="2.3" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#reading-data"><i class="fa fa-check"></i><b>2.3</b> Reading data</a></li>
<li class="chapter" data-level="2.4" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#our-first-ggplot"><i class="fa fa-check"></i><b>2.4</b> Our first ggplot</a></li>
<li class="chapter" data-level="2.5" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#change-point-type"><i class="fa fa-check"></i><b>2.5</b> Change point type</a></li>
<li class="chapter" data-level="2.6" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#set-colors"><i class="fa fa-check"></i><b>2.6</b> Set colors</a></li>
<li class="chapter" data-level="2.7" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#controlling-color-with-a-third-variable-and-other-functions"><i class="fa fa-check"></i><b>2.7</b> Controlling color with a third variable and other functions</a></li>
<li class="chapter" data-level="2.8" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#plotting-multiple-groups-adding-a-third-variable"><i class="fa fa-check"></i><b>2.8</b> Plotting multiple groups (adding a third variable)</a></li>
<li class="chapter" data-level="2.9" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#facets"><i class="fa fa-check"></i><b>2.9</b> Facets</a></li>
<li class="chapter" data-level="2.10" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#two-variable-faceting"><i class="fa fa-check"></i><b>2.10</b> Two variable faceting</a></li>
<li class="chapter" data-level="2.11" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#boxplots"><i class="fa fa-check"></i><b>2.11</b> Boxplots</a></li>
<li class="chapter" data-level="2.12" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#more-about-color-size-etc"><i class="fa fa-check"></i><b>2.12</b> More about color, size, etc</a></li>
<li class="chapter" data-level="2.13" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#multiple-geoms"><i class="fa fa-check"></i><b>2.13</b> Multiple geoms</a></li>
<li class="chapter" data-level="2.14" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#exit-ticket"><i class="fa fa-check"></i><b>2.14</b> Exit ticket</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html"><i class="fa fa-check"></i><b>3</b> Data wrangling using tidyverse</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#learning-objectives-1"><i class="fa fa-check"></i><b>3.2</b> Learning objectives:</a></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#you-can-use-r-as-a-calculator"><i class="fa fa-check"></i><b>3.3</b> You can use R as a calculator</a></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#you-can-create-new-objects-using--"><i class="fa fa-check"></i><b>3.4</b> You can create new objects using &lt;-</a></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#using-functions"><i class="fa fa-check"></i><b>3.5</b> Using functions</a></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#read-in-some-data"><i class="fa fa-check"></i><b>3.6</b> Read in some data</a></li>
<li class="chapter" data-level="3.7" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#what-is-a-tibble"><i class="fa fa-check"></i><b>3.7</b> What is a tibble?</a></li>
<li class="chapter" data-level="3.8" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#data-wrangling-in-dplyr"><i class="fa fa-check"></i><b>3.8</b> Data wrangling in dplyr</a></li>
<li class="chapter" data-level="3.9" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#filter"><i class="fa fa-check"></i><b>3.9</b> Filter</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#multiple-conditions"><i class="fa fa-check"></i><b>3.9.1</b> Multiple conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#arrange"><i class="fa fa-check"></i><b>3.10</b> Arrange</a></li>
<li class="chapter" data-level="3.11" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#select"><i class="fa fa-check"></i><b>3.11</b> Select</a></li>
<li class="chapter" data-level="3.12" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#mutate"><i class="fa fa-check"></i><b>3.12</b> Mutate</a></li>
<li class="chapter" data-level="3.13" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#summarize"><i class="fa fa-check"></i><b>3.13</b> Summarize</a></li>
<li class="chapter" data-level="3.14" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#multiple-operations-with-pipes"><i class="fa fa-check"></i><b>3.14</b> Multiple operations with pipes</a></li>
<li class="chapter" data-level="3.15" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#a-final-comment-on-nas"><i class="fa fa-check"></i><b>3.15</b> A final comment on NAs</a></li>
<li class="chapter" data-level="3.16" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#thats-it-for-today"><i class="fa fa-check"></i><b>3.16</b> That’s it for today</a></li>
<li class="chapter" data-level="3.17" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#exit-ticket-1"><i class="fa fa-check"></i><b>3.17</b> Exit ticket</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html"><i class="fa fa-check"></i><b>4</b> Lab 1: Data vis, wrangling, and programming (12 pts)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#problem-1-1-pts"><i class="fa fa-check"></i><b>4.1</b> Problem 1 (1 pts)</a></li>
<li class="chapter" data-level="4.2" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#problem-2-1-pts"><i class="fa fa-check"></i><b>4.2</b> Problem 2 (1 pts)</a></li>
<li class="chapter" data-level="4.3" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#problem-3-2-pts"><i class="fa fa-check"></i><b>4.3</b> Problem 3 (2 pts)</a></li>
<li class="chapter" data-level="4.4" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#problem-4-2-pts"><i class="fa fa-check"></i><b>4.4</b> Problem 4 (2 pts)</a></li>
<li class="chapter" data-level="4.5" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#problem-5-2-pts"><i class="fa fa-check"></i><b>4.5</b> Problem 5 (2 pts)</a></li>
<li class="chapter" data-level="4.6" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#problem-6-2-pts"><i class="fa fa-check"></i><b>4.6</b> Problem 6 (2 pts)</a></li>
<li class="chapter" data-level="4.7" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#summary-2-pts"><i class="fa fa-check"></i><b>4.7</b> Summary (2 pts)</a></li>
<li class="chapter" data-level="4.8" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#feeback"><i class="fa fa-check"></i><b>4.8</b> Feeback</a></li>
<li class="chapter" data-level="4.9" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#deliverables"><i class="fa fa-check"></i><b>4.9</b> Deliverables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dataretrieval.html"><a href="dataretrieval.html"><i class="fa fa-check"></i><b>5</b> dataRetrieval</a>
<ul>
<li class="chapter" data-level="5.1" data-path="dataretrieval.html"><a href="dataretrieval.html#goals"><i class="fa fa-check"></i><b>5.1</b> Goals</a></li>
<li class="chapter" data-level="5.2" data-path="dataretrieval.html"><a href="dataretrieval.html#exploring-what-dataretrieval-can-do"><i class="fa fa-check"></i><b>5.2</b> Exploring what dataRetrieval can do</a></li>
<li class="chapter" data-level="5.3" data-path="dataretrieval.html"><a href="dataretrieval.html#first-lets-map-these-sites."><i class="fa fa-check"></i><b>5.3</b> First, let’s map these sites.</a></li>
<li class="chapter" data-level="5.4" data-path="dataretrieval.html"><a href="dataretrieval.html#joins"><i class="fa fa-check"></i><b>5.4</b> Joins</a></li>
<li class="chapter" data-level="5.5" data-path="dataretrieval.html"><a href="dataretrieval.html#join-practice-example"><i class="fa fa-check"></i><b>5.5</b> Join practice example</a></li>
<li class="chapter" data-level="5.6" data-path="dataretrieval.html"><a href="dataretrieval.html#now-we-know-what-is-available-so-lets-download-some-data-from-the-gallatin-site-using-readnwisdata."><i class="fa fa-check"></i><b>5.6</b> Now we know what is available so let’s download some data from the Gallatin site using “readNWISdata”.</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><a href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><i class="fa fa-check"></i><b>6</b> Lab 2: dataRetrieval and area normalized flows (20 pts)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><a href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html#intro"><i class="fa fa-check"></i><b>6.1</b> Intro</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><a href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html#this-is-knitr-settings.-knitr-is-a-package-that-will-turn-this-rmd-to-an-html."><i class="fa fa-check"></i><b>6.1.1</b> This is knitr settings. Knitr is a package that will turn this Rmd to an html.</a></li>
<li class="chapter" data-level="6.1.2" data-path="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><a href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html#load-the-necessary-packages."><i class="fa fa-check"></i><b>6.1.2</b> Load the necessary packages.</a></li>
<li class="chapter" data-level="6.1.3" data-path="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><a href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html#workflow"><i class="fa fa-check"></i><b>6.1.3</b> Workflow</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><a href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html#summary-14-pts"><i class="fa fa-check"></i><b>6.2</b> Summary (14 pts)</a></li>
<li class="chapter" data-level="6.3" data-path="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><a href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html#deliverable-6-pts"><i class="fa fa-check"></i><b>6.3</b> Deliverable (6 pts)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html"><i class="fa fa-check"></i><b>7</b> Statistics in hydrology</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#learning-objectives-2"><i class="fa fa-check"></i><b>7.1</b> Learning objectives</a></li>
<li class="chapter" data-level="7.2" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#homework-q1-2-pts"><i class="fa fa-check"></i><b>7.2</b> Homework Q1 (2 pts)</a></li>
<li class="chapter" data-level="7.3" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#what-is-the-difference-between-a-sample-and-a-population"><i class="fa fa-check"></i><b>7.3</b> What is the difference between a sample and a population?</a></li>
<li class="chapter" data-level="7.4" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#homework-q2-2-pts"><i class="fa fa-check"></i><b>7.4</b> Homework Q2 (2 pts)</a></li>
<li class="chapter" data-level="7.5" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#measuring-our-sample-distribution-central-tendency"><i class="fa fa-check"></i><b>7.5</b> Measuring our sample distribution: central tendency</a></li>
<li class="chapter" data-level="7.6" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#so-whats-a-weighted-average"><i class="fa fa-check"></i><b>7.6</b> So what’s a weighted average?</a></li>
<li class="chapter" data-level="7.7" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#measures-of-variability"><i class="fa fa-check"></i><b>7.7</b> Measures of variability</a></li>
<li class="chapter" data-level="7.8" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#homework-q3-2-pts"><i class="fa fa-check"></i><b>7.8</b> Homework Q3 (2 pts)</a></li>
<li class="chapter" data-level="7.9" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#what-is-a-normal-distribution-and-how-can-we-determine-if-we-have-one"><i class="fa fa-check"></i><b>7.9</b> What is a normal distribution and how can we determine if we have one?</a></li>
<li class="chapter" data-level="7.10" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#homework-q4-2-pts"><i class="fa fa-check"></i><b>7.10</b> Homework Q4 (2 pts)</a></li>
<li class="chapter" data-level="7.11" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#homework-q5-2-pts"><i class="fa fa-check"></i><b>7.11</b> Homework Q5 (2 pts)</a></li>
<li class="chapter" data-level="7.12" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#deliverable-10-pts-due-thursday-215-by-1159-pm"><i class="fa fa-check"></i><b>7.12</b> Deliverable (10 pts, due Thursday 2/15 by 11:59 PM)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html"><i class="fa fa-check"></i><b>8</b> Lab 3: Statistics in hydrology (33 pts)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html#problem-1-5-pts"><i class="fa fa-check"></i><b>8.1</b> Problem 1 (5 pts)</a></li>
<li class="chapter" data-level="8.2" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html#problem-2-5-pts"><i class="fa fa-check"></i><b>8.2</b> Problem 2 (5 pts)</a></li>
<li class="chapter" data-level="8.3" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html#problem-3-5-pts"><i class="fa fa-check"></i><b>8.3</b> Problem 3 (5 pts)</a></li>
<li class="chapter" data-level="8.4" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html#problem-4-5-pts"><i class="fa fa-check"></i><b>8.4</b> Problem 4 (5 pts)</a></li>
<li class="chapter" data-level="8.5" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html#problem-5-5-pts"><i class="fa fa-check"></i><b>8.5</b> Problem 5 (5 pts)</a></li>
<li class="chapter" data-level="8.6" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html#problem-6-5-pts"><i class="fa fa-check"></i><b>8.6</b> Problem 6 (5 pts)</a></li>
<li class="chapter" data-level="8.7" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html#deliverable"><i class="fa fa-check"></i><b>8.7</b> Deliverable</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html"><i class="fa fa-check"></i><b>9</b> Hydrographs and rating curves (6 pts)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#overall-learning-objectives"><i class="fa fa-check"></i><b>9.1</b> Overall Learning Objectives</a></li>
<li class="chapter" data-level="9.2" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#reading"><i class="fa fa-check"></i><b>9.2</b> Reading</a></li>
<li class="chapter" data-level="9.3" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#lecture"><i class="fa fa-check"></i><b>9.3</b> Lecture</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#hydrographs-and-rating-curves"><i class="fa fa-check"></i><b>9.3.1</b> Hydrographs and Rating Curves</a></li>
<li class="chapter" data-level="9.3.2" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#rain-versus-snow-dominated-systems"><i class="fa fa-check"></i><b>9.3.2</b> Rain versus Snow dominated systems</a></li>
<li class="chapter" data-level="9.3.3" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#field-measurements-of-area-velocity"><i class="fa fa-check"></i><b>9.3.3</b> Field Measurements of Area-Velocity</a></li>
<li class="chapter" data-level="9.3.4" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#making-stage-measurements"><i class="fa fa-check"></i><b>9.3.4</b> Making Stage Measurements</a></li>
<li class="chapter" data-level="9.3.5" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#applications-of-streamflow-and-stream-gage"><i class="fa fa-check"></i><b>9.3.5</b> Applications of streamflow and stream gage</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#optional-activity-to-gain-deeper-understanding-of-rating-curve"><i class="fa fa-check"></i><b>9.4</b> Optional activity to gain deeper understanding of rating curve</a></li>
<li class="chapter" data-level="9.5" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#summary-questions-and-deliverable-6-pts"><i class="fa fa-check"></i><b>9.5</b> Summary questions and deliverable (6 pts)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html"><i class="fa fa-check"></i><b>10</b> Lab 4: Rating cuve lab (15 pts)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html#problem-1"><i class="fa fa-check"></i><b>10.1</b> Problem 1</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html#q1.1.-3-pts"><i class="fa fa-check"></i><b>10.1.1</b> Q1.1. (3 pts)</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html#problem-2"><i class="fa fa-check"></i><b>10.2</b> Problem 2</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html#q2.1.-2-pt"><i class="fa fa-check"></i><b>10.2.1</b> Q2.1. (2 pt)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html#problem-3"><i class="fa fa-check"></i><b>10.3</b> Problem 3</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html#q3.1.-5-pts"><i class="fa fa-check"></i><b>10.3.1</b> Q3.1. (5 pts)</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html#problem-4"><i class="fa fa-check"></i><b>10.4</b> Problem 4</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="flow-duration-curves-12-pts.html"><a href="flow-duration-curves-12-pts.html"><i class="fa fa-check"></i><b>11</b> Flow Duration Curves (12 pts)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="flow-duration-curves-12-pts.html"><a href="flow-duration-curves-12-pts.html#lecture-1"><i class="fa fa-check"></i><b>11.1</b> Lecture</a></li>
<li class="chapter" data-level="11.2" data-path="flow-duration-curves-12-pts.html"><a href="flow-duration-curves-12-pts.html#reading-1"><i class="fa fa-check"></i><b>11.2</b> Reading</a></li>
<li class="chapter" data-level="11.3" data-path="flow-duration-curves-12-pts.html"><a href="flow-duration-curves-12-pts.html#packages-and-coding"><i class="fa fa-check"></i><b>11.3</b> Packages and coding</a></li>
<li class="chapter" data-level="11.4" data-path="flow-duration-curves-12-pts.html"><a href="flow-duration-curves-12-pts.html#get-data"><i class="fa fa-check"></i><b>11.4</b> Get data</a></li>
<li class="chapter" data-level="11.5" data-path="flow-duration-curves-12-pts.html"><a href="flow-duration-curves-12-pts.html#review-describe-the-distribution"><i class="fa fa-check"></i><b>11.5</b> Review: describe the distribution</a></li>
<li class="chapter" data-level="11.6" data-path="flow-duration-curves-12-pts.html"><a href="flow-duration-curves-12-pts.html#ecdfs"><i class="fa fa-check"></i><b>11.6</b> ECDFs</a></li>
<li class="chapter" data-level="11.7" data-path="flow-duration-curves-12-pts.html"><a href="flow-duration-curves-12-pts.html#calculate-flow-exceedence-probabilities"><i class="fa fa-check"></i><b>11.7</b> Calculate flow exceedence probabilities</a></li>
<li class="chapter" data-level="11.8" data-path="flow-duration-curves-12-pts.html"><a href="flow-duration-curves-12-pts.html#plot-a-flow-duration-curve-using-the-probabilities"><i class="fa fa-check"></i><b>11.8</b> Plot a Flow Duration Curve using the probabilities</a></li>
<li class="chapter" data-level="11.9" data-path="flow-duration-curves-12-pts.html"><a href="flow-duration-curves-12-pts.html#example-use-of-an-fdc"><i class="fa fa-check"></i><b>11.9</b> Example use of an FDC</a></li>
<li class="chapter" data-level="11.10" data-path="flow-duration-curves-12-pts.html"><a href="flow-duration-curves-12-pts.html#module-question-1-2-pts-describe-the-differences-in-flow-regime-you-see-between-the-three-periods-of-1960-1980-1980-2000-and-2000-2020."><i class="fa fa-check"></i><b>11.10</b> Module Question 1 (2 pts): Describe the differences in flow regime you see between the three periods of 1960-1980, 1980-2000, and 2000-2020.</a></li>
<li class="chapter" data-level="11.11" data-path="flow-duration-curves-12-pts.html"><a href="flow-duration-curves-12-pts.html#compare-to-a-boxplot-of-the-same-data"><i class="fa fa-check"></i><b>11.11</b> Compare to a boxplot of the same data</a></li>
<li class="chapter" data-level="11.12" data-path="flow-duration-curves-12-pts.html"><a href="flow-duration-curves-12-pts.html#module-question-2-2-pts-what-are-the-advantagesdisadvantages-of-the-flow-duration-curves-vs.-boxplots"><i class="fa fa-check"></i><b>11.12</b> Module Question 2 (2 pts): What are the advantages/disadvantages of the flow duration curves vs. boxplots?</a></li>
<li class="chapter" data-level="11.13" data-path="flow-duration-curves-12-pts.html"><a href="flow-duration-curves-12-pts.html#module-summary-assignment-examining-flow-regime-change-at-the-grand-canyon-12-pts"><i class="fa fa-check"></i><b>11.13</b> Module Summary Assignment: Examining flow regime change at the Grand Canyon (12 pts)</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html"><i class="fa fa-check"></i><b>12</b> Lab 5: Low Flow Analysis (15 pts)</a>
<ul>
<li class="chapter" data-level="12.1" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#what-are-low-flow-statistics"><i class="fa fa-check"></i><b>12.1</b> What are low flow statistics?</a></li>
<li class="chapter" data-level="12.2" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#get-data-1"><i class="fa fa-check"></i><b>12.2</b> Get data</a></li>
<li class="chapter" data-level="12.3" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#create-the-x-days-average-flow-record"><i class="fa fa-check"></i><b>12.3</b> Create the X days average flow record</a></li>
<li class="chapter" data-level="12.4" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#look-at-what-a-rolling-mean-does."><i class="fa fa-check"></i><b>12.4</b> Look at what a rolling mean does.</a></li>
<li class="chapter" data-level="12.5" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#calculate-yearly-minimums"><i class="fa fa-check"></i><b>12.5</b> Calculate yearly minimums</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#challenge"><i class="fa fa-check"></i><b>12.5.1</b> Challenge</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#calculate-return-interval"><i class="fa fa-check"></i><b>12.6</b> Calculate return interval</a></li>
<li class="chapter" data-level="12.7" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#fit-to-pearson-type-iii-distribution"><i class="fa fa-check"></i><b>12.7</b> Fit to Pearson Type III distribution</a></li>
<li class="chapter" data-level="12.8" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#deliverable---summary-questions-12-pts"><i class="fa fa-check"></i><b>12.8</b> Deliverable - Summary questions (12 pts)</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#question-1-6-pts"><i class="fa fa-check"></i><b>12.8.1</b> Question 1 (6 pts)</a></li>
<li class="chapter" data-level="12.8.2" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#question-2-3-pts"><i class="fa fa-check"></i><b>12.8.2</b> Question 2 (3 pts)</a></li>
<li class="chapter" data-level="12.8.3" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#question-3-6-pts"><i class="fa fa-check"></i><b>12.8.3</b> Question 3 (6 pts)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>13</b> Functions</a>
<ul>
<li class="chapter" data-level="13.1" data-path="functions.html"><a href="functions.html#reading-on-functions-from-rds-by-hadley-wickham"><i class="fa fa-check"></i><b>13.1</b> Reading on functions from RDS by Hadley Wickham</a></li>
<li class="chapter" data-level="13.2" data-path="functions.html"><a href="functions.html#tutorial"><i class="fa fa-check"></i><b>13.2</b> Tutorial</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="climate-trend-analysis.html"><a href="climate-trend-analysis.html"><i class="fa fa-check"></i><b>14</b> Climate trend analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="climate-trend-analysis.html"><a href="climate-trend-analysis.html#summary-questions-and-deliverable"><i class="fa fa-check"></i><b>14.1</b> Summary questions and deliverable</a></li>
<li class="chapter" data-level="14.2" data-path="climate-trend-analysis.html"><a href="climate-trend-analysis.html#new-packages"><i class="fa fa-check"></i><b>14.2</b> New packages</a></li>
<li class="chapter" data-level="14.3" data-path="climate-trend-analysis.html"><a href="climate-trend-analysis.html#data-download-exploration-and-cleaning"><i class="fa fa-check"></i><b>14.3</b> Data download, exploration and cleaning</a></li>
<li class="chapter" data-level="14.4" data-path="climate-trend-analysis.html"><a href="climate-trend-analysis.html#computing-annual-values"><i class="fa fa-check"></i><b>14.4</b> Computing annual values</a></li>
<li class="chapter" data-level="14.5" data-path="climate-trend-analysis.html"><a href="climate-trend-analysis.html#exploratory-data-analysis-eda-of-annual-values"><i class="fa fa-check"></i><b>14.5</b> Exploratory data analysis (EDA) of annual values</a></li>
<li class="chapter" data-level="14.6" data-path="climate-trend-analysis.html"><a href="climate-trend-analysis.html#trend-analysis-and-creating-table-1"><i class="fa fa-check"></i><b>14.6</b> Trend analysis and creating Table 1</a></li>
<li class="chapter" data-level="14.7" data-path="climate-trend-analysis.html"><a href="climate-trend-analysis.html#see-summary-section-at-top-for-questions-to-answer-and-deliverable."><i class="fa fa-check"></i><b>14.7</b> See summary section at top for questions to answer and deliverable.</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="for-loops.html"><a href="for-loops.html"><i class="fa fa-check"></i><b>15</b> For loops</a>
<ul>
<li class="chapter" data-level="15.1" data-path="for-loops.html"><a href="for-loops.html#libraries"><i class="fa fa-check"></i><b>15.1</b> Libraries</a></li>
<li class="chapter" data-level="15.2" data-path="for-loops.html"><a href="for-loops.html#defining-parameters"><i class="fa fa-check"></i><b>15.2</b> Defining parameters</a></li>
<li class="chapter" data-level="15.3" data-path="for-loops.html"><a href="for-loops.html#writing-the-for-loop"><i class="fa fa-check"></i><b>15.3</b> Writing the for loop</a></li>
<li class="chapter" data-level="15.4" data-path="for-loops.html"><a href="for-loops.html#adding-second-for"><i class="fa fa-check"></i><b>15.4</b> Adding second for</a></li>
<li class="chapter" data-level="15.5" data-path="for-loops.html"><a href="for-loops.html#removing-the-tmp-file"><i class="fa fa-check"></i><b>15.5</b> Removing the tmp file</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="geospatial-r-raster---hydro-analyses.html"><a href="geospatial-r-raster---hydro-analyses.html"><i class="fa fa-check"></i><b>16</b> Geospatial R Raster - Hydro Analyses</a>
<ul>
<li class="chapter" data-level="16.1" data-path="geospatial-r-raster---hydro-analyses.html"><a href="geospatial-r-raster---hydro-analyses.html#introduction-2"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="geospatial-r-raster---hydro-analyses.html"><a href="geospatial-r-raster---hydro-analyses.html#read-in-dem"><i class="fa fa-check"></i><b>16.2</b> Read in DEM</a></li>
<li class="chapter" data-level="16.3" data-path="geospatial-r-raster---hydro-analyses.html"><a href="geospatial-r-raster---hydro-analyses.html#plot-dem"><i class="fa fa-check"></i><b>16.3</b> Plot DEM</a></li>
<li class="chapter" data-level="16.4" data-path="geospatial-r-raster---hydro-analyses.html"><a href="geospatial-r-raster---hydro-analyses.html#generate-a-hillshade"><i class="fa fa-check"></i><b>16.4</b> Generate a hillshade</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="geospatial-r-raster---hydro-analyses.html"><a href="geospatial-r-raster---hydro-analyses.html#how-whitebox-tools-functions-work"><i class="fa fa-check"></i><b>16.4.1</b> How whitebox tools functions work</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="geospatial-r-raster---hydro-analyses.html"><a href="geospatial-r-raster---hydro-analyses.html#prepare-dem-for-hydrology-analyses"><i class="fa fa-check"></i><b>16.5</b> Prepare DEM for Hydrology Analyses</a></li>
<li class="chapter" data-level="16.6" data-path="geospatial-r-raster---hydro-analyses.html"><a href="geospatial-r-raster---hydro-analyses.html#visualize-filled-sinks-and-breached-depressions"><i class="fa fa-check"></i><b>16.6</b> Visualize filled sinks and breached depressions</a></li>
<li class="chapter" data-level="16.7" data-path="geospatial-r-raster---hydro-analyses.html"><a href="geospatial-r-raster---hydro-analyses.html#d8-flow-accumulation"><i class="fa fa-check"></i><b>16.7</b> D8 Flow Accumulation</a></li>
<li class="chapter" data-level="16.8" data-path="geospatial-r-raster---hydro-analyses.html"><a href="geospatial-r-raster---hydro-analyses.html#d-infinity-flow-accumulation"><i class="fa fa-check"></i><b>16.8</b> D infinity flow accumulation</a></li>
<li class="chapter" data-level="16.9" data-path="geospatial-r-raster---hydro-analyses.html"><a href="geospatial-r-raster---hydro-analyses.html#topographic-wetness-index"><i class="fa fa-check"></i><b>16.9</b> Topographic Wetness Index</a></li>
<li class="chapter" data-level="16.10" data-path="geospatial-r-raster---hydro-analyses.html"><a href="geospatial-r-raster---hydro-analyses.html#map-stream-network"><i class="fa fa-check"></i><b>16.10</b> Map Stream Network</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Watershed Analysis: ENSC 445/LRES 545</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="geospatial-r-raster---hydro-analyses" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">Chapter 16</span> Geospatial R Raster - Hydro Analyses<a href="geospatial-r-raster---hydro-analyses.html#geospatial-r-raster---hydro-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-2" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> Introduction<a href="geospatial-r-raster---hydro-analyses.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For more: <a href="https://geocompr.robinlovelace.net/spatial-class.html#raster-data" class="uri">https://geocompr.robinlovelace.net/spatial-class.html#raster-data</a></p>
<p>To read in detail about any of the WhiteboxTools used in this activity, check out the user manual: <a href="https://jblindsay.github.io/wbt_book/intro.html" class="uri">https://jblindsay.github.io/wbt_book/intro.html</a></p>
<p>In this activity we are going to explore how to work with raster data in R while computing several hydrologically-relevant landscape metrics using the R package whitebox tools. Whitebox is very powerful and has an extensive set of tools, but it is not on CRAN. You must install it with the commented-out line at the top of the next code chunk.</p>
<p>Install/Load necessary packages and data:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="geospatial-r-raster---hydro-analyses.html#cb172-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb172-2"><a href="geospatial-r-raster---hydro-analyses.html#cb172-2" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb172-3"><a href="geospatial-r-raster---hydro-analyses.html#cb172-3" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb172-4"><a href="geospatial-r-raster---hydro-analyses.html#cb172-4" tabindex="-1"></a><span class="fu">library</span>(whitebox)</span>
<span id="cb172-5"><a href="geospatial-r-raster---hydro-analyses.html#cb172-5" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb172-6"><a href="geospatial-r-raster---hydro-analyses.html#cb172-6" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb172-7"><a href="geospatial-r-raster---hydro-analyses.html#cb172-7" tabindex="-1"></a><span class="fu">library</span>(mapview)</span>
<span id="cb172-8"><a href="geospatial-r-raster---hydro-analyses.html#cb172-8" tabindex="-1"></a></span>
<span id="cb172-9"><a href="geospatial-r-raster---hydro-analyses.html#cb172-9" tabindex="-1"></a><span class="co">#If installing/using whitebox for the first time</span></span>
<span id="cb172-10"><a href="geospatial-r-raster---hydro-analyses.html#cb172-10" tabindex="-1"></a><span class="co">#whitebox::install_whitebox()</span></span>
<span id="cb172-11"><a href="geospatial-r-raster---hydro-analyses.html#cb172-11" tabindex="-1"></a></span>
<span id="cb172-12"><a href="geospatial-r-raster---hydro-analyses.html#cb172-12" tabindex="-1"></a>whitebox<span class="sc">::</span><span class="fu">wbt_init</span>()</span>
<span id="cb172-13"><a href="geospatial-r-raster---hydro-analyses.html#cb172-13" tabindex="-1"></a></span>
<span id="cb172-14"><a href="geospatial-r-raster---hydro-analyses.html#cb172-14" tabindex="-1"></a><span class="co">#theme_set(theme_classic())</span></span></code></pre></div>
</div>
<div id="read-in-dem" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> Read in DEM<a href="geospatial-r-raster---hydro-analyses.html#read-in-dem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we will set tmap to either plot or view depending on how we want to see our maps.</p>
<p>For this activity we are going to use a 5-meter DEM of a portion of a Brush Mountain outside Blacksburg, VA.</p>
<p><em>What does DEM stand for? What does it show?<br />
</em>What does it mean that the DEM is “5-meter”?</p>
<p>We will use raster() to load the DEM. We let R know that coordinate system is WGS84 by setting the crs argument equal to ‘+init=EPSG:4326’, where 4326 is the EPSG number for WGS84.</p>
<p>Next, an artifact of outputting the DEM for this analysis is that there are a bunch of errant cells around the border that don’t belong in the DEM. If we make a map with them, it really throws off the scale. So we are going to set any elevation values below 1500 ft to NA. Note how this is done as if the dem was just a normal vector, which is pretty handy.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="geospatial-r-raster---hydro-analyses.html#cb173-1" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;view&quot;</span>) <span class="co"># view is interactive. map is static. </span></span>
<span id="cb173-2"><a href="geospatial-r-raster---hydro-analyses.html#cb173-2" tabindex="-1"></a></span>
<span id="cb173-3"><a href="geospatial-r-raster---hydro-analyses.html#cb173-3" tabindex="-1"></a></span>
<span id="cb173-4"><a href="geospatial-r-raster---hydro-analyses.html#cb173-4" tabindex="-1"></a>dem <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;McDonaldHollowDEM/brushDEMsm_5m.tif&quot;</span>, <span class="at">crs =</span> <span class="st">&#39;+init=EPSG:4326&#39;</span>)</span>
<span id="cb173-5"><a href="geospatial-r-raster---hydro-analyses.html#cb173-5" tabindex="-1"></a></span>
<span id="cb173-6"><a href="geospatial-r-raster---hydro-analyses.html#cb173-6" tabindex="-1"></a><span class="fu">mapview</span>(dem)</span>
<span id="cb173-7"><a href="geospatial-r-raster---hydro-analyses.html#cb173-7" tabindex="-1"></a></span>
<span id="cb173-8"><a href="geospatial-r-raster---hydro-analyses.html#cb173-8" tabindex="-1"></a><span class="fu">writeRaster</span>(dem, <span class="st">&quot;McDonaldHollowDEM/brushDEMsm_5m_crs.tif&quot;</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>) </span>
<span id="cb173-9"><a href="geospatial-r-raster---hydro-analyses.html#cb173-9" tabindex="-1"></a></span>
<span id="cb173-10"><a href="geospatial-r-raster---hydro-analyses.html#cb173-10" tabindex="-1"></a>dem[dem <span class="sc">&lt;</span> <span class="dv">1500</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb173-11"><a href="geospatial-r-raster---hydro-analyses.html#cb173-11" tabindex="-1"></a></span>
<span id="cb173-12"><a href="geospatial-r-raster---hydro-analyses.html#cb173-12" tabindex="-1"></a><span class="fu">mapview</span>(dem)</span></code></pre></div>
</div>
<div id="plot-dem" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> Plot DEM<a href="geospatial-r-raster---hydro-analyses.html#plot-dem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now let’s plot the DEM.</p>
<p>Give tm_shape the raster, then visualize it with tm_raster. We will tell tmap that the scale on the raster is continuous, which color palette to use, whether or not to show the legend, and then add a scale bar.</p>
<p>Here is a link to different color palettes you can try</p>
<p><a href="http://www.sthda.com/english/wiki/colors-in-r" class="uri">http://www.sthda.com/english/wiki/colors-in-r</a></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="geospatial-r-raster---hydro-analyses.html#cb174-1" tabindex="-1"></a><span class="fu">tm_shape</span>(dem) <span class="sc">+</span></span>
<span id="cb174-2"><a href="geospatial-r-raster---hydro-analyses.html#cb174-2" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;viridis&quot;</span>, <span class="at">legend.show =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">&quot;Elevation (m)&quot;</span>) <span class="sc">+</span></span>
<span id="cb174-3"><a href="geospatial-r-raster---hydro-analyses.html#cb174-3" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>, <span class="fl">0.8</span>)) <span class="co"># can try viridis, spectral, and tmaptools::palette_explorer() for more color options</span></span></code></pre></div>
</div>
<div id="generate-a-hillshade" class="section level2 hasAnchor" number="16.4">
<h2><span class="header-section-number">16.4</span> Generate a hillshade<a href="geospatial-r-raster---hydro-analyses.html#generate-a-hillshade" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Since the DEM is just elevation values, it is tough to see much about the landscape. We can see the stream network and general features, but not much more. BUT those features are there! We just need other ways to illuminate them. One common way to visualize these kind of data is a hillshade. This basically “lights” the landscape with a synthetic sun, casting shadows and illuminating other features. You can control the angle of the sun and from what direction it is shining to control the look of the image. We will position the sun in the south-south east so it illuminates the south side of Brush Mountain well.</p>
<p>We will use the whitebox tools function wbt_hillshade() to produce a hillshade.</p>
<div id="how-whitebox-tools-functions-work" class="section level3 hasAnchor" number="16.4.1">
<h3><span class="header-section-number">16.4.1</span> How whitebox tools functions work<a href="geospatial-r-raster---hydro-analyses.html#how-whitebox-tools-functions-work" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The whitebox tools functions can be a little tricky to work with at first. You might want to pass R objects to them and get R objects back, but that’s not how they are set up.</p>
<p>Basically for your input, you tell the wbt function the name of the file that has the input data.<br />
For output, you tell it what to name the output.</p>
<p>The wbt function then outputs the calculated data to your working directory, or whatever directory you give it in the output argument.</p>
<p>This means if you want to do something with the output of the wbt function, you have to read it in separately.</p>
<p>In the chunk below we will read in the brush mountain 5m DEM and output a hillshade with wbt_hillshad().</p>
<p>We will then read the output hillshade in with raster() and make a map with tmap. We will use the “Greys” palette in revers by adding a negative sign in front of it. This is just to make the hillshade look nice.</p>
<p>Notice how much more you can see in the landscape!</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="geospatial-r-raster---hydro-analyses.html#cb175-1" tabindex="-1"></a><span class="fu">wbt_hillshade</span>(<span class="at">dem =</span> <span class="st">&quot;McDonaldHollowDEM/brushDEMsm_5m_crs.tif&quot;</span>,</span>
<span id="cb175-2"><a href="geospatial-r-raster---hydro-analyses.html#cb175-2" tabindex="-1"></a>               <span class="at">output =</span> <span class="st">&quot;McDonaldHollowDEM/brush_hillshade.tif&quot;</span>,</span>
<span id="cb175-3"><a href="geospatial-r-raster---hydro-analyses.html#cb175-3" tabindex="-1"></a>               <span class="at">azimuth =</span> <span class="dv">115</span>)</span>
<span id="cb175-4"><a href="geospatial-r-raster---hydro-analyses.html#cb175-4" tabindex="-1"></a></span>
<span id="cb175-5"><a href="geospatial-r-raster---hydro-analyses.html#cb175-5" tabindex="-1"></a>hillshade <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;McDonaldHollowDEM/brush_hillshade.tif&quot;</span>)</span>
<span id="cb175-6"><a href="geospatial-r-raster---hydro-analyses.html#cb175-6" tabindex="-1"></a></span>
<span id="cb175-7"><a href="geospatial-r-raster---hydro-analyses.html#cb175-7" tabindex="-1"></a><span class="fu">tm_shape</span>(hillshade) <span class="sc">+</span></span>
<span id="cb175-8"><a href="geospatial-r-raster---hydro-analyses.html#cb175-8" tabindex="-1"></a>   <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;-Greys&quot;</span>, <span class="at">legend.show =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb175-9"><a href="geospatial-r-raster---hydro-analyses.html#cb175-9" tabindex="-1"></a>   <span class="fu">tm_scale_bar</span>()</span></code></pre></div>
</div>
</div>
<div id="prepare-dem-for-hydrology-analyses" class="section level2 hasAnchor" number="16.5">
<h2><span class="header-section-number">16.5</span> Prepare DEM for Hydrology Analyses<a href="geospatial-r-raster---hydro-analyses.html#prepare-dem-for-hydrology-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Alright, we are cooking now.</p>
<p>But we have to cool our jets for a second. If we are going to do hydrologic analyses, we have to prep our DEM a bit.</p>
<p>Our hydrologic tools often work on the premise of following water down the hillslope based on the elevation of the cells in the DEM. If, along a flowpath, there is no cell lower than a location, the algorithm we are using will stop there. This is called a sink, pit, or depression. See the figure below.</p>
<div class="float">
<img src="images/sink.png" title="Sink" alt="Sink" />
<div class="figcaption">Sink</div>
</div>
<p>We can deal with these features two ways. The first is to “fill” them. Which means the dead end cells will have their elevations raised until the pit is filled and water can flow downhill. See below.</p>
<div class="float">
<img src="images/filled.png" title="Filled" alt="Filled" />
<div class="figcaption">Filled</div>
</div>
<p>The second way we can deal with these features is to “breach” them. This means the side of the feature that is blocking flow will be lowered to allow water to flow downhill. See below.</p>
<div class="float">
<img src="images/breached.png" title="Breached" alt="Breached" />
<div class="figcaption">Breached</div>
</div>
<p>We are going to do both to prep our DEM. We will first breach depressions using wbt_breach_depressions_least_cost(), which will lower the elevation of the cells damming depressions.</p>
<p>To use this function we will also give it a maximum distance to search for a place to breach the depression (dist) and determine whether to fill any depressions leftover after it does its thing (fill).</p>
<p>Then, because this algorithm can leave some remaining depressions, we will use wbt_fill_depressions_wang_and_liu() to clean up any remaining issues.</p>
<p>Be careful to give wbt_fill_depressions_wang_and_liu() the result of the breach depressions function, not the original DEM!</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="geospatial-r-raster---hydro-analyses.html#cb176-1" tabindex="-1"></a><span class="fu">wbt_breach_depressions_least_cost</span>(</span>
<span id="cb176-2"><a href="geospatial-r-raster---hydro-analyses.html#cb176-2" tabindex="-1"></a>   <span class="at">dem =</span> <span class="st">&quot;McDonaldHollowDEM/brushDEMsm_5m_crs.tif&quot;</span>,</span>
<span id="cb176-3"><a href="geospatial-r-raster---hydro-analyses.html#cb176-3" tabindex="-1"></a>   <span class="at">output =</span> <span class="st">&quot;McDonaldHollowDEM/bmstationdem_breached.tif&quot;</span>,</span>
<span id="cb176-4"><a href="geospatial-r-raster---hydro-analyses.html#cb176-4" tabindex="-1"></a>   <span class="at">dist =</span> <span class="dv">5</span>,</span>
<span id="cb176-5"><a href="geospatial-r-raster---hydro-analyses.html#cb176-5" tabindex="-1"></a>   <span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb176-6"><a href="geospatial-r-raster---hydro-analyses.html#cb176-6" tabindex="-1"></a> </span>
<span id="cb176-7"><a href="geospatial-r-raster---hydro-analyses.html#cb176-7" tabindex="-1"></a><span class="fu">wbt_fill_depressions_wang_and_liu</span>(</span>
<span id="cb176-8"><a href="geospatial-r-raster---hydro-analyses.html#cb176-8" tabindex="-1"></a>   <span class="at">dem =</span> <span class="st">&quot;McDonaldHollowDEM/bmstationdem_breached.tif&quot;</span>,</span>
<span id="cb176-9"><a href="geospatial-r-raster---hydro-analyses.html#cb176-9" tabindex="-1"></a>   <span class="at">output =</span> <span class="st">&quot;McDonaldHollowDEM/bmstationdem_filled_breached.tif&quot;</span>)</span></code></pre></div>
</div>
<div id="visualize-filled-sinks-and-breached-depressions" class="section level2 hasAnchor" number="16.6">
<h2><span class="header-section-number">16.6</span> Visualize filled sinks and breached depressions<a href="geospatial-r-raster---hydro-analyses.html#visualize-filled-sinks-and-breached-depressions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now let’s look at what this did. This is a great example of how easily you can use multiple rasters together.</p>
<p>If we want to see how the fill and breach operations changed the DEM, we can just subtract the filled and breached DEM from the original. Then, in areas where nothing changed, the values will be zero, areas that were filled will be positive, and areas that were decreased in elevation to “breach” a depression will be negative.</p>
<p>To more easily see where stuff happened, we will set all the cells that equal zero to NA. Then we will plot them on the hillshade.</p>
<p>Where where changes made?</p>
<p>What do you think these pit/depression features represent in real life?</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="geospatial-r-raster---hydro-analyses.html#cb177-1" tabindex="-1"></a>filled_breached <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;McDonaldHollowDEM/bmstationdem_filled_breached.tif&quot;</span>)</span>
<span id="cb177-2"><a href="geospatial-r-raster---hydro-analyses.html#cb177-2" tabindex="-1"></a></span>
<span id="cb177-3"><a href="geospatial-r-raster---hydro-analyses.html#cb177-3" tabindex="-1"></a><span class="do">## What did this do?</span></span>
<span id="cb177-4"><a href="geospatial-r-raster---hydro-analyses.html#cb177-4" tabindex="-1"></a>difference <span class="ot">&lt;-</span> dem <span class="sc">-</span> filled_breached</span>
<span id="cb177-5"><a href="geospatial-r-raster---hydro-analyses.html#cb177-5" tabindex="-1"></a> </span>
<span id="cb177-6"><a href="geospatial-r-raster---hydro-analyses.html#cb177-6" tabindex="-1"></a>difference[difference <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb177-7"><a href="geospatial-r-raster---hydro-analyses.html#cb177-7" tabindex="-1"></a></span>
<span id="cb177-8"><a href="geospatial-r-raster---hydro-analyses.html#cb177-8" tabindex="-1"></a><span class="co"># Try with and without the hillshade. </span></span>
<span id="cb177-9"><a href="geospatial-r-raster---hydro-analyses.html#cb177-9" tabindex="-1"></a><span class="fu">tm_shape</span>(hillshade) <span class="sc">+</span></span>
<span id="cb177-10"><a href="geospatial-r-raster---hydro-analyses.html#cb177-10" tabindex="-1"></a>   <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;-Greys&quot;</span>, <span class="at">legend.show =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb177-11"><a href="geospatial-r-raster---hydro-analyses.html#cb177-11" tabindex="-1"></a>   <span class="fu">tm_scale_bar</span>() </span>
<span id="cb177-12"><a href="geospatial-r-raster---hydro-analyses.html#cb177-12" tabindex="-1"></a></span>
<span id="cb177-13"><a href="geospatial-r-raster---hydro-analyses.html#cb177-13" tabindex="-1"></a><span class="fu">tm_shape</span>(difference) <span class="sc">+</span></span>
<span id="cb177-14"><a href="geospatial-r-raster---hydro-analyses.html#cb177-14" tabindex="-1"></a>   <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">legend.show =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb177-15"><a href="geospatial-r-raster---hydro-analyses.html#cb177-15" tabindex="-1"></a>   <span class="fu">tm_scale_bar</span>()</span></code></pre></div>
</div>
<div id="d8-flow-accumulation" class="section level2 hasAnchor" number="16.7">
<h2><span class="header-section-number">16.7</span> D8 Flow Accumulation<a href="geospatial-r-raster---hydro-analyses.html#d8-flow-accumulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first hydrological analysis we will perform is the D8 flow accumulation algorithm. In whitebox this is wbt_d8_flow_accumulation(). We give the function the DEM, and for each cell, it determines the direction water fill flow from that cell. To do this it looks at the elevation of the surrounding cells relative to the current cell. In the D8 algorithm, the flow direction can be one of 8 directions, shown in the figure below. All flow from the current cell is moved to the cell to which the flow direction points.</p>
<p>Using another function, we can just output the flow direction for each cell. This will be important when we delineate a watershed, but for visualization and many analysis purposes, we just want to look at the flow accumulation.</p>
<p>This tool outputs a raster that tells us how many cells drain to each cell. In other words, for a given cell in the raster, its value corresponds to the number of cells that drain to it. As a result, this highlights streams quite well.</p>
<div class="float">
<img src="images/D8%20flow%20direction.png" title="D8 Flow Direction" alt="D8 Flow Direction" />
<div class="figcaption">D8 Flow Direction</div>
</div>
<p>The wbt_d8_flow_accumulation() function takes an input of a DEM or a flow direction (pointer) file. We will pass it a filled, breached DEM. The default output is the number of cells draining to each cell, but you can also choose contributing area.</p>
<p>We will visualize our output buy plotting the log of the D8 flow accumulation grid over the hillshade with an opacity (alpha) of 0.5 using the alpha parameter in tm_raster. Mapping with the hillshade helps us see the flow accumulation in the context of the landscape. Plotting the log values helps us see differences in flow accumulation, because the high values are so much higher than the low values in a flow accumulation grid.</p>
<p>Where are the highest values?
Where are the lowest values?
Play with changing colors and alpha. What looks best?</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="geospatial-r-raster---hydro-analyses.html#cb178-1" tabindex="-1"></a><span class="fu">wbt_d8_flow_accumulation</span>(<span class="at">input =</span> <span class="st">&quot;McDonaldHollowDEM/bmstationdem_filled_breached.tif&quot;</span>,</span>
<span id="cb178-2"><a href="geospatial-r-raster---hydro-analyses.html#cb178-2" tabindex="-1"></a>                          <span class="at">output =</span> <span class="st">&quot;McDonaldHollowDEM/D8FA.tif&quot;</span>)</span>
<span id="cb178-3"><a href="geospatial-r-raster---hydro-analyses.html#cb178-3" tabindex="-1"></a> </span>
<span id="cb178-4"><a href="geospatial-r-raster---hydro-analyses.html#cb178-4" tabindex="-1"></a>d8 <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;McDonaldHollowDEM/D8FA.tif&quot;</span>)</span>
<span id="cb178-5"><a href="geospatial-r-raster---hydro-analyses.html#cb178-5" tabindex="-1"></a></span>
<span id="cb178-6"><a href="geospatial-r-raster---hydro-analyses.html#cb178-6" tabindex="-1"></a><span class="fu">tm_shape</span>(hillshade) <span class="sc">+</span></span>
<span id="cb178-7"><a href="geospatial-r-raster---hydro-analyses.html#cb178-7" tabindex="-1"></a>   <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>,<span class="at">palette =</span> <span class="st">&quot;-Greys&quot;</span>, <span class="at">legend.show =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb178-8"><a href="geospatial-r-raster---hydro-analyses.html#cb178-8" tabindex="-1"></a> <span class="fu">tm_shape</span>(<span class="fu">log</span>(d8))<span class="sc">+</span></span>
<span id="cb178-9"><a href="geospatial-r-raster---hydro-analyses.html#cb178-9" tabindex="-1"></a>   <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;GnBu&quot;</span>, <span class="at">legend.show =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.95</span>) <span class="sc">+</span></span>
<span id="cb178-10"><a href="geospatial-r-raster---hydro-analyses.html#cb178-10" tabindex="-1"></a>   <span class="fu">tm_scale_bar</span>()</span></code></pre></div>
</div>
<div id="d-infinity-flow-accumulation" class="section level2 hasAnchor" number="16.8">
<h2><span class="header-section-number">16.8</span> D infinity flow accumulation<a href="geospatial-r-raster---hydro-analyses.html#d-infinity-flow-accumulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another method of calculating flow accumulation is the D infinity algorithm. This operates similarly to the D8 algorithm but with some important differences.</p>
<p>With D infinity, the flow direction for each cell can be any angle. Endless possibilities!</p>
<p>If the angle does not point squarely at one of the neighboring cells, the flow from the focus cell can be SPLIT between neighboring cells. We will see the resulting difference this makes when we look at the output.</p>
<div class="float">
<img src="images/dinf-flow%20direction.png" title="D inf Flow Direction" alt="D inf Flow Direction" />
<div class="figcaption">D inf Flow Direction</div>
</div>
<p>The function for d infinity is wbt_d_inf_flow_accumulation() and like the D8 function it will take a flow direction (pointer) file or a DEM. We will give it the filled and breached DEM.</p>
<p>As with the D8 data, we will plot the logged accumulation values over a hillshade with 50% opacity (or a different value if you like).</p>
<p>How does this look different from the D8 results?</p>
<p>Which do you think represents reality better? Why?</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="geospatial-r-raster---hydro-analyses.html#cb179-1" tabindex="-1"></a><span class="fu">wbt_d_inf_flow_accumulation</span>(<span class="at">input =</span> <span class="st">&quot;McDonaldHollowDEM/bmstationdem_filled_breached.tif&quot;</span>,</span>
<span id="cb179-2"><a href="geospatial-r-raster---hydro-analyses.html#cb179-2" tabindex="-1"></a>                          <span class="at">output =</span> <span class="st">&quot;McDonaldHollowDEM/DinfFA.tif&quot;</span>, </span>
<span id="cb179-3"><a href="geospatial-r-raster---hydro-analyses.html#cb179-3" tabindex="-1"></a>                          <span class="at">out_type =</span> <span class="st">&quot;cells&quot;</span>)</span>
<span id="cb179-4"><a href="geospatial-r-raster---hydro-analyses.html#cb179-4" tabindex="-1"></a></span>
<span id="cb179-5"><a href="geospatial-r-raster---hydro-analyses.html#cb179-5" tabindex="-1"></a>dinf <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;McDonaldHollowDEM/DinfFA.tif&quot;</span>)</span>
<span id="cb179-6"><a href="geospatial-r-raster---hydro-analyses.html#cb179-6" tabindex="-1"></a></span>
<span id="cb179-7"><a href="geospatial-r-raster---hydro-analyses.html#cb179-7" tabindex="-1"></a><span class="fu">tm_shape</span>(hillshade) <span class="sc">+</span></span>
<span id="cb179-8"><a href="geospatial-r-raster---hydro-analyses.html#cb179-8" tabindex="-1"></a>   <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>,<span class="at">palette =</span> <span class="st">&quot;-Greys&quot;</span>, <span class="at">legend.show =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb179-9"><a href="geospatial-r-raster---hydro-analyses.html#cb179-9" tabindex="-1"></a> <span class="fu">tm_shape</span>(<span class="fu">log</span>(dinf)) <span class="sc">+</span></span>
<span id="cb179-10"><a href="geospatial-r-raster---hydro-analyses.html#cb179-10" tabindex="-1"></a>   <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;GnBu&quot;</span>, <span class="at">legend.show =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb179-11"><a href="geospatial-r-raster---hydro-analyses.html#cb179-11" tabindex="-1"></a>   <span class="fu">tm_scale_bar</span>()</span></code></pre></div>
</div>
<div id="topographic-wetness-index" class="section level2 hasAnchor" number="16.9">
<h2><span class="header-section-number">16.9</span> Topographic Wetness Index<a href="geospatial-r-raster---hydro-analyses.html#topographic-wetness-index" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The topographic wetness index (TWI) combines flow accumulation with the slope of each cell to calculate a index that basically corresponds to how likely an area is to be wet. If we think about a landscape, an area with a lot of contributing area and a flat slope is more likely to be wet (e.g., riparian areas) than an area with a lot of contributing area and a steep slope. That’s what TWI models.</p>
<p>The formula for TWI is</p>
<p><span class="math inline">\(TWI = Ln(As / tan(Slope))\)</span></p>
<p>Where As is the specific contributing area and Slope is the slope at the cell. Specific contributing area is contributing area per unit contour length (which is just a confusing way of saying the contributing area to any cell in the raster).</p>
<p>This is the first function we will use that doesn’t just take a DEM as input. The wbt_wetness_index() function takes a raster of specific contributing area and another of slope. We will need to create each of these first and then pass them to the function.</p>
<p>We will then plot TWI with the same approach we used for the flow accumulation data.</p>
<p>We get some funkiness around the edges of the DEM, so we will also filter the TWI output so the visualization looks better.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="geospatial-r-raster---hydro-analyses.html#cb180-1" tabindex="-1"></a><span class="fu">wbt_d_inf_flow_accumulation</span>(<span class="at">input =</span> <span class="st">&quot;McDonaldHollowDEM/bmstationdem_filled_breached.tif&quot;</span>,</span>
<span id="cb180-2"><a href="geospatial-r-raster---hydro-analyses.html#cb180-2" tabindex="-1"></a>                             <span class="at">output =</span> <span class="st">&quot;McDonaldHollowDEM/DinfFAsca.tif&quot;</span>,</span>
<span id="cb180-3"><a href="geospatial-r-raster---hydro-analyses.html#cb180-3" tabindex="-1"></a>                             <span class="at">out_type =</span> <span class="st">&quot;Specific Contributing Area&quot;</span>)</span>
<span id="cb180-4"><a href="geospatial-r-raster---hydro-analyses.html#cb180-4" tabindex="-1"></a></span>
<span id="cb180-5"><a href="geospatial-r-raster---hydro-analyses.html#cb180-5" tabindex="-1"></a></span>
<span id="cb180-6"><a href="geospatial-r-raster---hydro-analyses.html#cb180-6" tabindex="-1"></a><span class="fu">wbt_slope</span>(<span class="at">dem =</span> <span class="st">&quot;McDonaldHollowDEM/bmstationdem_filled_breached.tif&quot;</span>,</span>
<span id="cb180-7"><a href="geospatial-r-raster---hydro-analyses.html#cb180-7" tabindex="-1"></a>           <span class="at">output =</span> <span class="st">&quot;McDonaldHollowDEM/demslope.tif&quot;</span>,</span>
<span id="cb180-8"><a href="geospatial-r-raster---hydro-analyses.html#cb180-8" tabindex="-1"></a>           <span class="at">units =</span> <span class="st">&quot;degrees&quot;</span>)</span>
<span id="cb180-9"><a href="geospatial-r-raster---hydro-analyses.html#cb180-9" tabindex="-1"></a></span>
<span id="cb180-10"><a href="geospatial-r-raster---hydro-analyses.html#cb180-10" tabindex="-1"></a><span class="fu">wbt_wetness_index</span>(<span class="at">sca =</span> <span class="st">&quot;McDonaldHollowDEM/DinfFAsca.tif&quot;</span>,</span>
<span id="cb180-11"><a href="geospatial-r-raster---hydro-analyses.html#cb180-11" tabindex="-1"></a>                   <span class="at">slope =</span> <span class="st">&quot;McDonaldHollowDEM/demslope.tif&quot;</span>,</span>
<span id="cb180-12"><a href="geospatial-r-raster---hydro-analyses.html#cb180-12" tabindex="-1"></a>                   <span class="at">output =</span> <span class="st">&quot;McDonaldHollowDEM/TWI.tif&quot;</span>)</span>
<span id="cb180-13"><a href="geospatial-r-raster---hydro-analyses.html#cb180-13" tabindex="-1"></a> </span>
<span id="cb180-14"><a href="geospatial-r-raster---hydro-analyses.html#cb180-14" tabindex="-1"></a>twi <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;McDonaldHollowDEM/TWI.tif&quot;</span>)</span>
<span id="cb180-15"><a href="geospatial-r-raster---hydro-analyses.html#cb180-15" tabindex="-1"></a> </span>
<span id="cb180-16"><a href="geospatial-r-raster---hydro-analyses.html#cb180-16" tabindex="-1"></a>twi[twi <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb180-17"><a href="geospatial-r-raster---hydro-analyses.html#cb180-17" tabindex="-1"></a></span>
<span id="cb180-18"><a href="geospatial-r-raster---hydro-analyses.html#cb180-18" tabindex="-1"></a><span class="fu">tm_shape</span>(hillshade) <span class="sc">+</span></span>
<span id="cb180-19"><a href="geospatial-r-raster---hydro-analyses.html#cb180-19" tabindex="-1"></a>   <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;-Greys&quot;</span>, <span class="at">legend.show =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb180-20"><a href="geospatial-r-raster---hydro-analyses.html#cb180-20" tabindex="-1"></a> <span class="fu">tm_shape</span>(twi) <span class="sc">+</span></span>
<span id="cb180-21"><a href="geospatial-r-raster---hydro-analyses.html#cb180-21" tabindex="-1"></a>   <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;-GnBu&quot;</span>, <span class="at">legend.show =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb180-22"><a href="geospatial-r-raster---hydro-analyses.html#cb180-22" tabindex="-1"></a>   <span class="fu">tm_scale_bar</span>()</span></code></pre></div>
</div>
<div id="map-stream-network" class="section level2 hasAnchor" number="16.10">
<h2><span class="header-section-number">16.10</span> Map Stream Network<a href="geospatial-r-raster---hydro-analyses.html#map-stream-network" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One very useful thing we can do with the flow accumulation grids we calculated, is map the stream network in a watershed. If we look at either flow accumulation grid we can see the highest values are in the streams. Therefore if we determine the flow accumulation value at the highest place on the stream network with consistent flow, we can set all cells with a flow accumulation lower than that to NA and we will only have cells that are in the stream.</p>
<p>Often, we actually want our stream network to be represented as lines, so we then have to convert that raster to a vector format.</p>
<p>Whitebox Tools has two handy functions to let us do this: wbt_extract_streams() makes a raster of the stream network by using a threshold flow accumulation you give it. It takes a D8 flow accumulation grid as input.</p>
<p>Then wbt_raster_streams_to_vector() will take the output from wbt_extract_streams() and a D8 pointer file and output a shapefile of your stream network.</p>
<p>Below we extract the streams, generate a D8 pointer file, and then convert the raster streams to vector. We will then plot the streams on the hillshade.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="geospatial-r-raster---hydro-analyses.html#cb181-1" tabindex="-1"></a><span class="fu">wbt_extract_streams</span>(<span class="at">flow_accum =</span> <span class="st">&quot;McDonaldHollowDEM/D8FA.tif&quot;</span>,</span>
<span id="cb181-2"><a href="geospatial-r-raster---hydro-analyses.html#cb181-2" tabindex="-1"></a>                     <span class="at">output =</span> <span class="st">&quot;McDonaldHollowDEM/raster_streams.tif&quot;</span>,</span>
<span id="cb181-3"><a href="geospatial-r-raster---hydro-analyses.html#cb181-3" tabindex="-1"></a>                     <span class="at">threshold =</span> <span class="dv">6000</span>)</span>
<span id="cb181-4"><a href="geospatial-r-raster---hydro-analyses.html#cb181-4" tabindex="-1"></a> </span>
<span id="cb181-5"><a href="geospatial-r-raster---hydro-analyses.html#cb181-5" tabindex="-1"></a><span class="fu">wbt_d8_pointer</span>(<span class="at">dem =</span> <span class="st">&quot;McDonaldHollowDEM/bmstationdem_filled_breached.tif&quot;</span>,</span>
<span id="cb181-6"><a href="geospatial-r-raster---hydro-analyses.html#cb181-6" tabindex="-1"></a>                <span class="at">output =</span> <span class="st">&quot;McDonaldHollowDEM/D8pointer.tif&quot;</span>)</span>
<span id="cb181-7"><a href="geospatial-r-raster---hydro-analyses.html#cb181-7" tabindex="-1"></a></span>
<span id="cb181-8"><a href="geospatial-r-raster---hydro-analyses.html#cb181-8" tabindex="-1"></a><span class="fu">wbt_raster_streams_to_vector</span>(<span class="at">streams =</span> <span class="st">&quot;McDonaldHollowDEM/raster_streams.tif&quot;</span>,</span>
<span id="cb181-9"><a href="geospatial-r-raster---hydro-analyses.html#cb181-9" tabindex="-1"></a>                              <span class="at">d8_pntr =</span> <span class="st">&quot;McDonaldHollowDEM/D8pointer.tif&quot;</span>,</span>
<span id="cb181-10"><a href="geospatial-r-raster---hydro-analyses.html#cb181-10" tabindex="-1"></a>                              <span class="at">output =</span> <span class="st">&quot;McDonaldHollowDEM/streams.shp&quot;</span>)</span>
<span id="cb181-11"><a href="geospatial-r-raster---hydro-analyses.html#cb181-11" tabindex="-1"></a> </span>
<span id="cb181-12"><a href="geospatial-r-raster---hydro-analyses.html#cb181-12" tabindex="-1"></a>streams <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;McDonaldHollowDEM/streams.shp&quot;</span>)</span>
<span id="cb181-13"><a href="geospatial-r-raster---hydro-analyses.html#cb181-13" tabindex="-1"></a></span>
<span id="cb181-14"><a href="geospatial-r-raster---hydro-analyses.html#cb181-14" tabindex="-1"></a><span class="fu">tm_shape</span>(hillshade)<span class="sc">+</span></span>
<span id="cb181-15"><a href="geospatial-r-raster---hydro-analyses.html#cb181-15" tabindex="-1"></a>   <span class="fu">tm_raster</span>(<span class="at">style =</span> <span class="st">&quot;cont&quot;</span>,<span class="at">palette =</span> <span class="st">&quot;-Greys&quot;</span>, <span class="at">legend.show =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb181-16"><a href="geospatial-r-raster---hydro-analyses.html#cb181-16" tabindex="-1"></a> <span class="fu">tm_shape</span>(streams)<span class="sc">+</span></span>
<span id="cb181-17"><a href="geospatial-r-raster---hydro-analyses.html#cb181-17" tabindex="-1"></a>   <span class="fu">tm_lines</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb181-18"><a href="geospatial-r-raster---hydro-analyses.html#cb181-18" tabindex="-1"></a>   <span class="fu">tm_scale_bar</span>()</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="for-loops.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tpcovino/ensc_445_545_bookdown/edit/master/16_geospatial_hydro.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/tpcovino/ensc_445_545_bookdown/blob/master/16_geospatial_hydro.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
