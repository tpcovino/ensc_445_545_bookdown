<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 dataRetrieval | Watershed Analysis: ENSC 445/LRES 545</title>
  <meta name="description" content="Chapter 5 dataRetrieval | Watershed Analysis: ENSC 445/LRES 545" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 dataRetrieval | Watershed Analysis: ENSC 445/LRES 545" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 dataRetrieval | Watershed Analysis: ENSC 445/LRES 545" />
  
  
  

<meta name="author" content="Tim Covino" />


<meta name="date" content="2024-02-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lab-1-data-vis-wrangling-and-programming-12-pts.html"/>
<link rel="next" href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
<link href="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.css" rel="stylesheet" />
<script src="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Watershed Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-overview-and-objectives"><i class="fa fa-check"></i><b>1.1</b> Course overview and objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i><b>1.2</b> Structure</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#tentative-schedule-subject-to-change"><i class="fa fa-check"></i><b>1.3</b> Tentative schedule, subject to change</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html"><i class="fa fa-check"></i><b>2</b> Intro to data visualization</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#download-and-install-tidyverse-library"><i class="fa fa-check"></i><b>2.2</b> Download and install tidyverse library</a></li>
<li class="chapter" data-level="2.3" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#reading-data"><i class="fa fa-check"></i><b>2.3</b> Reading data</a></li>
<li class="chapter" data-level="2.4" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#our-first-ggplot"><i class="fa fa-check"></i><b>2.4</b> Our first ggplot</a></li>
<li class="chapter" data-level="2.5" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#change-point-type"><i class="fa fa-check"></i><b>2.5</b> Change point type</a></li>
<li class="chapter" data-level="2.6" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#set-colors"><i class="fa fa-check"></i><b>2.6</b> Set colors</a></li>
<li class="chapter" data-level="2.7" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#controlling-color-with-a-third-variable-and-other-functions"><i class="fa fa-check"></i><b>2.7</b> Controlling color with a third variable and other functions</a></li>
<li class="chapter" data-level="2.8" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#plotting-multiple-groups-adding-a-third-variable"><i class="fa fa-check"></i><b>2.8</b> Plotting multiple groups (adding a third variable)</a></li>
<li class="chapter" data-level="2.9" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#facets"><i class="fa fa-check"></i><b>2.9</b> Facets</a></li>
<li class="chapter" data-level="2.10" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#two-variable-faceting"><i class="fa fa-check"></i><b>2.10</b> Two variable faceting</a></li>
<li class="chapter" data-level="2.11" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#boxplots"><i class="fa fa-check"></i><b>2.11</b> Boxplots</a></li>
<li class="chapter" data-level="2.12" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#more-about-color-size-etc"><i class="fa fa-check"></i><b>2.12</b> More about color, size, etc</a></li>
<li class="chapter" data-level="2.13" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#multiple-geoms"><i class="fa fa-check"></i><b>2.13</b> Multiple geoms</a></li>
<li class="chapter" data-level="2.14" data-path="intro-to-data-visualization.html"><a href="intro-to-data-visualization.html#exit-ticket"><i class="fa fa-check"></i><b>2.14</b> Exit ticket</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html"><i class="fa fa-check"></i><b>3</b> Data wrangling using tidyverse</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#learning-objectives-1"><i class="fa fa-check"></i><b>3.2</b> Learning objectives:</a></li>
<li class="chapter" data-level="3.3" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#you-can-use-r-as-a-calculator"><i class="fa fa-check"></i><b>3.3</b> You can use R as a calculator</a></li>
<li class="chapter" data-level="3.4" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#you-can-create-new-objects-using--"><i class="fa fa-check"></i><b>3.4</b> You can create new objects using &lt;-</a></li>
<li class="chapter" data-level="3.5" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#using-functions"><i class="fa fa-check"></i><b>3.5</b> Using functions</a></li>
<li class="chapter" data-level="3.6" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#read-in-some-data"><i class="fa fa-check"></i><b>3.6</b> Read in some data</a></li>
<li class="chapter" data-level="3.7" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#what-is-a-tibble"><i class="fa fa-check"></i><b>3.7</b> What is a tibble?</a></li>
<li class="chapter" data-level="3.8" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#data-wrangling-in-dplyr"><i class="fa fa-check"></i><b>3.8</b> Data wrangling in dplyr</a></li>
<li class="chapter" data-level="3.9" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#filter"><i class="fa fa-check"></i><b>3.9</b> Filter</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#multiple-conditions"><i class="fa fa-check"></i><b>3.9.1</b> Multiple conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#arrange"><i class="fa fa-check"></i><b>3.10</b> Arrange</a></li>
<li class="chapter" data-level="3.11" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#select"><i class="fa fa-check"></i><b>3.11</b> Select</a></li>
<li class="chapter" data-level="3.12" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#mutate"><i class="fa fa-check"></i><b>3.12</b> Mutate</a></li>
<li class="chapter" data-level="3.13" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#summarize"><i class="fa fa-check"></i><b>3.13</b> Summarize</a></li>
<li class="chapter" data-level="3.14" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#multiple-operations-with-pipes"><i class="fa fa-check"></i><b>3.14</b> Multiple operations with pipes</a></li>
<li class="chapter" data-level="3.15" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#a-final-comment-on-nas"><i class="fa fa-check"></i><b>3.15</b> A final comment on NAs</a></li>
<li class="chapter" data-level="3.16" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#thats-it-for-today"><i class="fa fa-check"></i><b>3.16</b> That’s it for today</a></li>
<li class="chapter" data-level="3.17" data-path="data-wrangling-using-tidyverse.html"><a href="data-wrangling-using-tidyverse.html#exit-ticket-1"><i class="fa fa-check"></i><b>3.17</b> Exit ticket</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html"><i class="fa fa-check"></i><b>4</b> Lab 1: Data vis, wrangling, and programming (12 pts)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#problem-1-1-pts"><i class="fa fa-check"></i><b>4.1</b> Problem 1 (1 pts)</a></li>
<li class="chapter" data-level="4.2" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#problem-2-1-pts"><i class="fa fa-check"></i><b>4.2</b> Problem 2 (1 pts)</a></li>
<li class="chapter" data-level="4.3" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#problem-3-2-pts"><i class="fa fa-check"></i><b>4.3</b> Problem 3 (2 pts)</a></li>
<li class="chapter" data-level="4.4" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#problem-4-2-pts"><i class="fa fa-check"></i><b>4.4</b> Problem 4 (2 pts)</a></li>
<li class="chapter" data-level="4.5" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#problem-5-2-pts"><i class="fa fa-check"></i><b>4.5</b> Problem 5 (2 pts)</a></li>
<li class="chapter" data-level="4.6" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#problem-6-2-pts"><i class="fa fa-check"></i><b>4.6</b> Problem 6 (2 pts)</a></li>
<li class="chapter" data-level="4.7" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#summary-2-pts"><i class="fa fa-check"></i><b>4.7</b> Summary (2 pts)</a></li>
<li class="chapter" data-level="4.8" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#feeback"><i class="fa fa-check"></i><b>4.8</b> Feeback</a></li>
<li class="chapter" data-level="4.9" data-path="lab-1-data-vis-wrangling-and-programming-12-pts.html"><a href="lab-1-data-vis-wrangling-and-programming-12-pts.html#deliverables"><i class="fa fa-check"></i><b>4.9</b> Deliverables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dataretrieval.html"><a href="dataretrieval.html"><i class="fa fa-check"></i><b>5</b> dataRetrieval</a>
<ul>
<li class="chapter" data-level="5.1" data-path="dataretrieval.html"><a href="dataretrieval.html#goals"><i class="fa fa-check"></i><b>5.1</b> Goals</a></li>
<li class="chapter" data-level="5.2" data-path="dataretrieval.html"><a href="dataretrieval.html#exploring-what-dataretrieval-can-do"><i class="fa fa-check"></i><b>5.2</b> Exploring what dataRetrieval can do</a></li>
<li class="chapter" data-level="5.3" data-path="dataretrieval.html"><a href="dataretrieval.html#first-lets-map-these-sites."><i class="fa fa-check"></i><b>5.3</b> First, let’s map these sites.</a></li>
<li class="chapter" data-level="5.4" data-path="dataretrieval.html"><a href="dataretrieval.html#joins"><i class="fa fa-check"></i><b>5.4</b> Joins</a></li>
<li class="chapter" data-level="5.5" data-path="dataretrieval.html"><a href="dataretrieval.html#join-practice-example"><i class="fa fa-check"></i><b>5.5</b> Join practice example</a></li>
<li class="chapter" data-level="5.6" data-path="dataretrieval.html"><a href="dataretrieval.html#now-we-know-what-is-available-so-lets-download-some-data-from-the-gallatin-site-using-readnwisdata."><i class="fa fa-check"></i><b>5.6</b> Now we know what is available so let’s download some data from the Gallatin site using “readNWISdata”.</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><a href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><i class="fa fa-check"></i><b>6</b> Lab 2: dataRetrieval and area normalized flows (20 pts)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><a href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html#intro"><i class="fa fa-check"></i><b>6.1</b> Intro</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><a href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html#this-is-knitr-settings.-knitr-is-a-package-that-will-turn-this-rmd-to-an-html."><i class="fa fa-check"></i><b>6.1.1</b> This is knitr settings. Knitr is a package that will turn this Rmd to an html.</a></li>
<li class="chapter" data-level="6.1.2" data-path="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><a href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html#load-the-necessary-packages."><i class="fa fa-check"></i><b>6.1.2</b> Load the necessary packages.</a></li>
<li class="chapter" data-level="6.1.3" data-path="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><a href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html#workflow"><i class="fa fa-check"></i><b>6.1.3</b> Workflow</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><a href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html#summary-14-pts"><i class="fa fa-check"></i><b>6.2</b> Summary (14 pts)</a></li>
<li class="chapter" data-level="6.3" data-path="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html"><a href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html#deliverable-6-pts"><i class="fa fa-check"></i><b>6.3</b> Deliverable (6 pts)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html"><i class="fa fa-check"></i><b>7</b> Statistics in hydrology</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#learning-objectives-2"><i class="fa fa-check"></i><b>7.1</b> Learning objectives</a></li>
<li class="chapter" data-level="7.2" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#homework-q1-2-pts"><i class="fa fa-check"></i><b>7.2</b> Homework Q1 (2 pts)</a></li>
<li class="chapter" data-level="7.3" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#what-is-the-difference-between-a-sample-and-a-population"><i class="fa fa-check"></i><b>7.3</b> What is the difference between a sample and a population?</a></li>
<li class="chapter" data-level="7.4" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#homework-q2-2-pts"><i class="fa fa-check"></i><b>7.4</b> Homework Q2 (2 pts)</a></li>
<li class="chapter" data-level="7.5" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#measuring-our-sample-distribution-central-tendency"><i class="fa fa-check"></i><b>7.5</b> Measuring our sample distribution: central tendency</a></li>
<li class="chapter" data-level="7.6" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#so-whats-a-weighted-average"><i class="fa fa-check"></i><b>7.6</b> So what’s a weighted average?</a></li>
<li class="chapter" data-level="7.7" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#measures-of-variability"><i class="fa fa-check"></i><b>7.7</b> Measures of variability</a></li>
<li class="chapter" data-level="7.8" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#homework-q3-2-pts"><i class="fa fa-check"></i><b>7.8</b> Homework Q3 (2 pts)</a></li>
<li class="chapter" data-level="7.9" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#what-is-a-normal-distribution-and-how-can-we-determine-if-we-have-one"><i class="fa fa-check"></i><b>7.9</b> What is a normal distribution and how can we determine if we have one?</a></li>
<li class="chapter" data-level="7.10" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#homework-q4-2-pts"><i class="fa fa-check"></i><b>7.10</b> Homework Q4 (2 pts)</a></li>
<li class="chapter" data-level="7.11" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#homework-q5-2-pts"><i class="fa fa-check"></i><b>7.11</b> Homework Q5 (2 pts)</a></li>
<li class="chapter" data-level="7.12" data-path="statistics-in-hydrology.html"><a href="statistics-in-hydrology.html#deliverable-10-pts-due-thursday-215-by-1159-pm"><i class="fa fa-check"></i><b>7.12</b> Deliverable (10 pts, due Thursday 2/15 by 11:59 PM)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html"><i class="fa fa-check"></i><b>8</b> Lab 3: Statistics in hydrology (33 pts)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html#problem-1-5-pts"><i class="fa fa-check"></i><b>8.1</b> Problem 1 (5 pts)</a></li>
<li class="chapter" data-level="8.2" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html#problem-2-5-pts"><i class="fa fa-check"></i><b>8.2</b> Problem 2 (5 pts)</a></li>
<li class="chapter" data-level="8.3" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html#problem-3-5-pts"><i class="fa fa-check"></i><b>8.3</b> Problem 3 (5 pts)</a></li>
<li class="chapter" data-level="8.4" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html#problem-4-5-pts"><i class="fa fa-check"></i><b>8.4</b> Problem 4 (5 pts)</a></li>
<li class="chapter" data-level="8.5" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html#problem-5-5-pts"><i class="fa fa-check"></i><b>8.5</b> Problem 5 (5 pts)</a></li>
<li class="chapter" data-level="8.6" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html#problem-6-5-pts"><i class="fa fa-check"></i><b>8.6</b> Problem 6 (5 pts)</a></li>
<li class="chapter" data-level="8.7" data-path="lab-3-statistics-in-hydrology-33-pts.html"><a href="lab-3-statistics-in-hydrology-33-pts.html#deliverable"><i class="fa fa-check"></i><b>8.7</b> Deliverable</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html"><i class="fa fa-check"></i><b>9</b> Hydrographs and rating curves (6 pts)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#overall-learning-objectives"><i class="fa fa-check"></i><b>9.1</b> Overall Learning Objectives</a></li>
<li class="chapter" data-level="9.2" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#reading"><i class="fa fa-check"></i><b>9.2</b> Reading</a></li>
<li class="chapter" data-level="9.3" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#lecture"><i class="fa fa-check"></i><b>9.3</b> Lecture</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#hydrographs-and-rating-curves"><i class="fa fa-check"></i><b>9.3.1</b> Hydrographs and Rating Curves</a></li>
<li class="chapter" data-level="9.3.2" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#rain-versus-snow-dominated-systems"><i class="fa fa-check"></i><b>9.3.2</b> Rain versus Snow dominated systems</a></li>
<li class="chapter" data-level="9.3.3" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#field-measurements-of-area-velocity"><i class="fa fa-check"></i><b>9.3.3</b> Field Measurements of Area-Velocity</a></li>
<li class="chapter" data-level="9.3.4" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#making-stage-measurements"><i class="fa fa-check"></i><b>9.3.4</b> Making Stage Measurements</a></li>
<li class="chapter" data-level="9.3.5" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#applications-of-streamflow-and-stream-gage"><i class="fa fa-check"></i><b>9.3.5</b> Applications of streamflow and stream gage</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#optional-activity-to-gain-deeper-understanding-of-rating-curve"><i class="fa fa-check"></i><b>9.4</b> Optional activity to gain deeper understanding of rating curve</a></li>
<li class="chapter" data-level="9.5" data-path="hydrographs-and-rating-curves-6-pts.html"><a href="hydrographs-and-rating-curves-6-pts.html#summary-questions-and-deliverable-6-pts"><i class="fa fa-check"></i><b>9.5</b> Summary questions and deliverable (6 pts)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html"><i class="fa fa-check"></i><b>10</b> Lab 4: Rating cuve lab (15 pts)</a>
<ul>
<li class="chapter" data-level="10.0.1" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html#this-is-knitr-settings.-knitr-is-a-package-that-will-turn-this-rmd-to-an-html.-1"><i class="fa fa-check"></i><b>10.0.1</b> This is knitr settings. Knitr is a package that will turn this Rmd to an html.</a></li>
<li class="chapter" data-level="10.1" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html#problem-1"><i class="fa fa-check"></i><b>10.1</b> Problem 1</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html#q1.1.-3-pts"><i class="fa fa-check"></i><b>10.1.1</b> Q1.1. (3 pts)</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html#problem-2"><i class="fa fa-check"></i><b>10.2</b> Problem 2</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html#q2.1.-2-pt"><i class="fa fa-check"></i><b>10.2.1</b> Q2.1. (2 pt)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html#problem-3"><i class="fa fa-check"></i><b>10.3</b> Problem 3</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html#q3.1.-5-pts"><i class="fa fa-check"></i><b>10.3.1</b> Q3.1. (5 pts)</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="lab-4-rating-cuve-lab-15-pts.html"><a href="lab-4-rating-cuve-lab-15-pts.html#problem-4"><i class="fa fa-check"></i><b>10.4</b> Problem 4</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="flow-duration-curves-8-pts.html"><a href="flow-duration-curves-8-pts.html"><i class="fa fa-check"></i><b>11</b> Flow Duration Curves (8 pts)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="flow-duration-curves-8-pts.html"><a href="flow-duration-curves-8-pts.html#lecture-1"><i class="fa fa-check"></i><b>11.1</b> Lecture</a></li>
<li class="chapter" data-level="11.2" data-path="flow-duration-curves-8-pts.html"><a href="flow-duration-curves-8-pts.html#reading-1"><i class="fa fa-check"></i><b>11.2</b> Reading</a></li>
<li class="chapter" data-level="11.3" data-path="flow-duration-curves-8-pts.html"><a href="flow-duration-curves-8-pts.html#packages-and-coding"><i class="fa fa-check"></i><b>11.3</b> Packages and coding</a></li>
<li class="chapter" data-level="11.4" data-path="flow-duration-curves-8-pts.html"><a href="flow-duration-curves-8-pts.html#get-data"><i class="fa fa-check"></i><b>11.4</b> Get data</a></li>
<li class="chapter" data-level="11.5" data-path="flow-duration-curves-8-pts.html"><a href="flow-duration-curves-8-pts.html#review-describe-the-distribution"><i class="fa fa-check"></i><b>11.5</b> Review: describe the distribution</a></li>
<li class="chapter" data-level="11.6" data-path="flow-duration-curves-8-pts.html"><a href="flow-duration-curves-8-pts.html#ecdfs"><i class="fa fa-check"></i><b>11.6</b> ECDFs</a></li>
<li class="chapter" data-level="11.7" data-path="flow-duration-curves-8-pts.html"><a href="flow-duration-curves-8-pts.html#calculate-flow-exceedence-probabilities"><i class="fa fa-check"></i><b>11.7</b> Calculate flow exceedence probabilities</a></li>
<li class="chapter" data-level="11.8" data-path="flow-duration-curves-8-pts.html"><a href="flow-duration-curves-8-pts.html#plot-a-flow-duration-curve-using-the-probabilities"><i class="fa fa-check"></i><b>11.8</b> Plot a Flow Duration Curve using the probabilities</a></li>
<li class="chapter" data-level="11.9" data-path="flow-duration-curves-8-pts.html"><a href="flow-duration-curves-8-pts.html#example-use-of-an-fdc"><i class="fa fa-check"></i><b>11.9</b> Example use of an FDC</a></li>
<li class="chapter" data-level="11.10" data-path="flow-duration-curves-8-pts.html"><a href="flow-duration-curves-8-pts.html#compare-to-a-boxplot-of-the-same-data"><i class="fa fa-check"></i><b>11.10</b> Compare to a boxplot of the same data</a></li>
<li class="chapter" data-level="11.11" data-path="flow-duration-curves-8-pts.html"><a href="flow-duration-curves-8-pts.html#assignment-examining-flow-regime-change-at-the-grand-canyon-8-pts"><i class="fa fa-check"></i><b>11.11</b> Assignment: Examining flow regime change at the Grand Canyon (8 pts)</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html"><i class="fa fa-check"></i><b>12</b> Lab 5: Low Flow Analysis (15 pts)</a>
<ul>
<li class="chapter" data-level="12.1" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#what-are-low-flow-statistics"><i class="fa fa-check"></i><b>12.1</b> What are low flow statistics?</a></li>
<li class="chapter" data-level="12.2" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#get-data-1"><i class="fa fa-check"></i><b>12.2</b> Get data</a></li>
<li class="chapter" data-level="12.3" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#create-the-x-days-average-flow-record"><i class="fa fa-check"></i><b>12.3</b> Create the X days average flow record</a></li>
<li class="chapter" data-level="12.4" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#look-at-what-a-rolling-mean-does."><i class="fa fa-check"></i><b>12.4</b> Look at what a rolling mean does.</a></li>
<li class="chapter" data-level="12.5" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#calculate-yearly-minimums"><i class="fa fa-check"></i><b>12.5</b> Calculate yearly minimums</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#challenge"><i class="fa fa-check"></i><b>12.5.1</b> Challenge</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#calculate-return-interval"><i class="fa fa-check"></i><b>12.6</b> Calculate return interval</a></li>
<li class="chapter" data-level="12.7" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#fit-to-pearson-type-iii-distribution"><i class="fa fa-check"></i><b>12.7</b> Fit to Pearson Type III distribution</a></li>
<li class="chapter" data-level="12.8" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#deliverable---summary-questions-12-pts"><i class="fa fa-check"></i><b>12.8</b> Deliverable - Summary questions (12 pts)</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#question-1-6-pts"><i class="fa fa-check"></i><b>12.8.1</b> Question 1 (6 pts)</a></li>
<li class="chapter" data-level="12.8.2" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#question-2-3-pts"><i class="fa fa-check"></i><b>12.8.2</b> Question 2 (3 pts)</a></li>
<li class="chapter" data-level="12.8.3" data-path="lab-5-low-flow-analysis-15-pts.html"><a href="lab-5-low-flow-analysis-15-pts.html#question-3-6-pts"><i class="fa fa-check"></i><b>12.8.3</b> Question 3 (6 pts)</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Watershed Analysis: ENSC 445/LRES 545</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dataretrieval" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> dataRetrieval<a href="dataretrieval.html#dataretrieval" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Readings: Introduction to the dataRetrieval package <a href="https://cran.r-project.org/web/packages/dataRetrieval/vignettes/dataRetrieval.html" target="_blank">https://cran.r-project.org/web/packages/dataRetrieval/vignettes/dataRetrieval.html</a></p>
<p>Chapter 12 &amp; 13 of R for Data Science <a href="https://r4ds.had.co.nz/tidy-data.html" target="_blank">https://r4ds.had.co.nz/tidy-data.html</a></p>
<p>Repo for this module can be found <a href="https://github.com/tpcovino/05_data_retrieval.git" target="_blank">here</a></p>
<div id="goals" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Goals<a href="dataretrieval.html#goals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Get familiar with the dataRetrieval package</li>
<li>Intro to joins</li>
<li>Learn about long vs. wide data and how to change between them</li>
</ul>
<p>Prep question: How would you get data from the USGS (non-R)? Test it out by downloading data for gauge 06050000.</p>
<p>See <a href="https://dashboard.waterdata.usgs.gov/app/nwd/en/?region=lower48&amp;aoi=default" target="_blank">here</a> for the national water dashboard. Then search for gage 06050000 and download data from 2010 - 2020.</p>
<p>It is good to know how to do that but dataRetrieval is going to make that much easier.</p>
<p>Install and load the necessary packages.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="dataretrieval.html#cb76-1" tabindex="-1"></a><span class="co">#install.packages(&quot;dataRetrieval&quot;)</span></span>
<span id="cb76-2"><a href="dataretrieval.html#cb76-2" tabindex="-1"></a><span class="co">#install.packages(&quot;leaflet&quot;)</span></span>
<span id="cb76-3"><a href="dataretrieval.html#cb76-3" tabindex="-1"></a><span class="fu">library</span>(dataRetrieval)</span>
<span id="cb76-4"><a href="dataretrieval.html#cb76-4" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb76-5"><a href="dataretrieval.html#cb76-5" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span></code></pre></div>
</div>
<div id="exploring-what-dataretrieval-can-do" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Exploring what dataRetrieval can do<a href="dataretrieval.html#exploring-what-dataretrieval-can-do" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Think about the dataRetrieval as a way to interact with same public data you can access through waterdata.usgs.gov but without having to click on buttons and search around. It makes getting data or doing analyses with USGS data much more reproducible and fast!</p>
<p>The documentation for the package is extremely helpful: <a href="https://cran.r-project.org/web/packages/dataRetrieval/vignettes/dataRetrieval.html" target="_blank">https://cran.r-project.org/web/packages/dataRetrieval/vignettes/dataRetrieval.html</a></p>
<p><a href="https://waterdata.usgs.gov/blog/dataretrieval/" target="_blank">https://waterdata.usgs.gov/blog/dataretrieval/</a></p>
<p>I always have to look up how to do things because the package is very specialized! This is the case with most website APIs, in my experience. It’s a good argument for getting good at navigating package documentation! Basically you just look through and try to piece together the recipe for what you want to do using the examples they give in the document.</p>
<p>First, let’s get some information about the gauging stations using the whatNWISsites(), readNWISsite(), and whatNWISdata() functions. Try each out and see what they tell you.</p>
<p>Remember, all the parameter codes and site names get passed to dataRetrieval functions as characters, so they must be in quotes.</p>
<p><a href="https://help.waterdata.usgs.gov/parameter_cd?group_cd=PHY" target="_blank">Link to parameter codes</a></p>
<p>Let’s use dataRetrieval to see what’s available in Montana.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="dataretrieval.html#cb77-1" tabindex="-1"></a><span class="co"># Load the stream gauge data</span></span>
<span id="cb77-2"><a href="dataretrieval.html#cb77-2" tabindex="-1"></a><span class="co"># Configs that could be changed ...</span></span>
<span id="cb77-3"><a href="dataretrieval.html#cb77-3" tabindex="-1"></a>param_cd <span class="ot">&lt;-</span> <span class="st">&quot;00060&quot;</span> <span class="co"># Parameter code for streamflow . See `dataRetrieval::parameterCdFile` for more.</span></span>
<span id="cb77-4"><a href="dataretrieval.html#cb77-4" tabindex="-1"></a>service_cd <span class="ot">&lt;-</span> <span class="st">&quot;dv&quot;</span> <span class="co"># means &quot;daily value&quot;. See `https://waterservices.usgs.gov/rest/` for more info.</span></span>
<span id="cb77-5"><a href="dataretrieval.html#cb77-5" tabindex="-1"></a><span class="co"># State code</span></span>
<span id="cb77-6"><a href="dataretrieval.html#cb77-6" tabindex="-1"></a>state_cd <span class="ot">&lt;-</span> <span class="st">&quot;MT&quot;</span></span>
<span id="cb77-7"><a href="dataretrieval.html#cb77-7" tabindex="-1"></a><span class="co"># set start and end dates for streamflow time series</span></span>
<span id="cb77-8"><a href="dataretrieval.html#cb77-8" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">as_date</span>(<span class="st">&quot;1990-10-01&quot;</span>)</span>
<span id="cb77-9"><a href="dataretrieval.html#cb77-9" tabindex="-1"></a>end <span class="ot">&lt;-</span> <span class="fu">as_date</span>(<span class="st">&quot;2022-10-01&quot;</span>)</span>
<span id="cb77-10"><a href="dataretrieval.html#cb77-10" tabindex="-1"></a></span>
<span id="cb77-11"><a href="dataretrieval.html#cb77-11" tabindex="-1"></a><span class="co"># Use whatNWISsites to identify what gauges exist that meet the above conditions. </span></span>
<span id="cb77-12"><a href="dataretrieval.html#cb77-12" tabindex="-1"></a>stream_gauges <span class="ot">&lt;-</span> <span class="fu">whatNWISsites</span>(<span class="at">parameterCd =</span> param_cd, <span class="at">service =</span> service_cd, <span class="at">stateCd =</span> state_cd, <span class="at">startDate =</span> start, <span class="at">endDate =</span> end) <span class="sc">%&gt;%</span> </span>
<span id="cb77-13"><a href="dataretrieval.html#cb77-13" tabindex="-1"></a>  <span class="fu">select</span>(site_no, station_nm, dec_lat_va, dec_long_va)</span></code></pre></div>
<p>Map the gauges using leaflet.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="dataretrieval.html#cb78-1" tabindex="-1"></a>mt_gauge_map <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="dataretrieval.html#cb78-2" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(<span class="st">&quot;OpenStreetMap&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-3"><a href="dataretrieval.html#cb78-3" tabindex="-1"></a>  <span class="fu">addAwesomeMarkers</span>(<span class="at">data =</span> stream_gauges, <span class="at">lat =</span> <span class="sc">~</span>dec_lat_va, <span class="at">lng =</span> <span class="sc">~</span>dec_long_va, <span class="at">label =</span> <span class="sc">~</span>station_nm, </span>
<span id="cb78-4"><a href="dataretrieval.html#cb78-4" tabindex="-1"></a>                    <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">&quot;Start date:&quot;</span>, start, <span class="st">&quot;&lt;br&gt;End date:&quot;</span>, end)) </span>
<span id="cb78-5"><a href="dataretrieval.html#cb78-5" tabindex="-1"></a>  </span>
<span id="cb78-6"><a href="dataretrieval.html#cb78-6" tabindex="-1"></a>mt_gauge_map</span></code></pre></div>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f5d42e648800dd78ca9c" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-f5d42e648800dd78ca9c">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["OpenStreetMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addAwesomeMarkers","args":[[48.5617222,48.4468611,47.9612444,48.34483889,48.4002194,48.9305472,48.1022259,47.5860611,48.40066389,48.35560278,47.5918583,47.2967111,48.89359167,47.30163889,48.8779472,47.4292,47.82982778,47.36679167,47.26630278,48.31905278,48.61005278,48.21725,48.16431667,47.31211389,48.22592778,45.72482778,48.3201861,47.6802861,48.2211361,47.1702972,48.5976861,48.3618111,45.97205,46.8686333,48.4957972,46.4432,48.1824589,48.092325,45.88301667,46.83173889,45.8735722,46.63308889,48.35657778,47.4914361,48.49551667,47.3228222,48.02423056,47.1472611,46.1607944,46.87676389,47.19555,46.8259111,45.54681667,46.8994111,48.757675,46.7223361,48.7954444,47.4223833,48.7988333,46.71737778,47.9790972,48.8299083,46.1845694,45.65903889,45.24579167,45.61796667,45.42286389,45.36098056,48.83303718,48.85277778,47.01867778,48.94696667,46.2927027,46.29527778,46.71191389,46.2990222,45.80754167,46.3960369,46.23266667,46.4637583,46.47165278,46.55011389,46.66381916,48.7534833,46.65937475,46.62872778,46.65326355,46.9794944,45.8508222,48.96352778,46.8907698,48.6168583,46.9187944,48.42695278,47.1032741,46.58998889,46.0829722,46.13366667,47.0567333,46.161325,46.0645111,47.6286083,47.6398611,45.44775,46.11437778,45.52843889,48.47802959,46.10716389,46.1077583,48.36945,46.5194833,46.5109111,46.180375,46.1794972,46.2185722,46.77777778,46.20824167,45.11612778,46.39765,45.7012694,45.52658056,48.24466667,47.61850556,45.74335,45.2183833,48.5077222,47.8830833,48.67847778,45.43631359,45.996575,45.99692778,45.4400944,45.99572778,45.9946694,45.9912694,46.00235,45.98520426,45.38338889,44.65588056,47.5471361,45.5500222,48.63340278,45.54688889,45.50691389,45.6132833,48.39110278,46.4115973,46.5238972,46.4889583,46.4813206,46.48493179,46.571975,45.74750278,45.1923194,46.6491021,45.2418694,47.199025,46.6021567,46.21103056,46.60500556,47.0054361,46.6319333,46.99473889,46.6607472,46.5190972,47.50162778,48.4271972,46.76619167,44.57740556,45.2331333,45.7230583,47.2694861,47.6250222,45.49023056,45.4865944,44.61579167,45.8971361,45.35626667,44.88865556,47.930325,47.56126667,46.33473889,47.52577778,45.88535556,46.1465722,47.70790556,47.43496667,47.18929167,48.44865556,44.86639167,45.4973,45.29727778,46.6784861,46.82798056,46.7033611,47.317175,46.80411556,46.7958,47.4050111,47.36828056,47.3891972,48.3059611,45.56332778,45.725425,44.6570722,45.72566667,47.5844444,46.59105,46.52708889,47.2085944,47.38373056,47.3454861,45.1121194,46.79958056,44.9923444,47.8169111,47.94590278,45.5972111,46.1671611,47.9327194,45.7383611,48.9748194,46.45324167,46.18480556,46.4623194,48.0037833,46.4769583,46.9177222,45.5123333,48.31035278,45.00283056,45.8337944,48.45269167,45.3943083,48.52671389,46.4288,48.2988333,48.1724444,45.24323889,45.25438735,48.5636861,48.22408056,47.6651583,48.17931667,48.1761472,46.35030278,48.5621444,46.31899167,47.0878333,45.53674167,48.5788694,45.0861472,45.43785,48.64949167,45.4221472,45.44990278,45.0099111,46.28905556,46.29231389,45.46571389,45.5163372,48.48964167,48.2237333,48.3248333,47.7547111,47.6105583,46.5976722,47.63143056,46.55433889,47.96575556,47.9311048,47.9286049,46.4277194,47.7046972,46.38720278,45.43467778,48.0310972,46.06635,45.8001194,48.3251472,47.93862778,48.3390361,47.9730333,48.3636333,47.99523889,48.40277778,45.8196944,46.522425,46.9286611,45.31690278,45.3163485,46.99469167,48.3621944,45.46079565,45.64413906,45.0071111,45.12648056,48.3567833,45.7305341,45.7356861,48.5405861,46.1244722,45.1010222,45.1771333,45.05626389,45.26796667,48.50920278,48.4203111,45.36116667,47.57884167,48.969375,45.0091361,48.30790556,46.24973056,45.141275,45.67582545,46.2666361,45.76715,45.29906389,46.19803056,46.26463056,45.41160556,48.13005278,47.3494472,48.044425,48.13586667,45.59775,45.58838889,45.8403861,47.5365944,45.0571972,46.4207722,46.3845944,46.18750218,48.9902861,46.22835556,48.09715556,47.4139722,48.067325,47.71578056,45.42743056,46.8500972,46.4294361,45.3898444,47.9022361,48.11791667,46.4205694,45.1642972,47.10588889,47.09420556,48.16448056,48.5095972,47.2637222,48.6728972,45.3870944,48.1235,48.80934167,48.4989472,48.56413889,48.50921389,47.67741389],[-115.9701583,-115.877136,-115.7335056,-115.6065694,-115.5536444,-115.4816306,-115.4089188,-115.3551,-115.3187194,-115.31465,-115.229536,-115.122625,-115.0878528,-115.0868694,-115.054461,-114.8565333,-114.6978333,-114.585,-114.4068444,-114.3871583,-114.3819278,-114.313736,-114.3015417,-114.2973778,-114.292661,-114.2822944,-114.2785944,-114.2467278,-114.241886,-114.2307944,-114.2247194,-114.18495,-114.1412333,-114.1277472,-114.1267639,-114.1237667,-114.1156748,-114.1153694,-114.0663139,-114.054861,-114.0534944,-114.0509583,-114.0378583,-114.0266444,-114.0102083,-113.9793806,-113.9788194,-113.974475,-113.9487194,-113.9321194,-113.850736,-113.8140306,-113.7638222,-113.7563194,-113.7246694,-113.683061,-113.6805833,-113.6709722,-113.6567306,-113.5893306,-113.5606833,-113.517211,-113.5015694,-113.4697306,-113.45715,-113.4569417,-113.4493944,-113.4409667,-113.4206533,-113.4169444,-113.3877,-113.3753306,-113.3422874,-113.33275,-113.3307806,-113.3296167,-113.3132694,-113.3083999,-113.2998722,-113.2402778,-113.2357694,-113.2147528,-113.168398,-113.1674306,-113.152008,-113.1506917,-113.1481189,-113.092186,-113.068361,-113.0623556,-113.0386674,-113.0361083,-113.014986,-112.9899833,-112.9603279,-112.9287139,-112.9171889,-112.9031528,-112.9011806,-112.8937972,-112.8935306,-112.865761,-112.8593333,-112.820425,-112.819775,-112.81825,-112.8139595,-112.810611,-112.8052833,-112.8017806,-112.7931722,-112.789686,-112.7850778,-112.780561,-112.7741667,-112.767786,-112.76735,-112.7504944,-112.7425389,-112.7359694,-112.701725,-112.6979167,-112.6920556,-112.6706639,-112.6553333,-112.6122694,-112.6119833,-112.5940056,-112.5639039,-112.5634889,-112.562861,-112.5560917,-112.538761,-112.5357139,-112.5273583,-112.513261,-112.5080764,-112.4528306,-112.3712222,-112.3674306,-112.360675,-112.3464806,-112.338111,-112.3308889,-112.3293972,-112.319661,-112.2969572,-112.2566472,-112.2487889,-112.2455657,-112.2444546,-112.2154778,-112.1872278,-112.1428167,-112.1213927,-112.1112389,-112.0959056,-112.095835,-112.09165,-112.0882639,-112.070311,-112.0470056,-112.0106667,-111.9899444,-111.946786,-111.9319139,-111.889836,-111.8887944,-111.7798639,-111.7516333,-111.741025,-111.6952306,-111.6354056,-111.6345056,-111.6338583,-111.6256694,-111.5956722,-111.5816222,-111.580886,-111.5529417,-111.5417694,-111.5313722,-111.511036,-111.438286,-111.4202778,-111.40915,-111.3884444,-111.3862389,-111.3453056,-111.3387806,-111.2707083,-111.2113917,-111.1939194,-111.1922389,-111.192225,-111.18805,-111.184118,-111.1785556,-111.1637083,-111.15905,-111.1387972,-111.0805278,-111.0718889,-111.0685917,-111.0679639,-111.0661944,-111.0605806,-111.0576861,-110.9666306,-110.9317472,-110.9284917,-110.8894278,-110.7936667,-110.7036694,-110.690975,-110.6661417,-110.5808389,-110.5664972,-110.5542861,-110.5144333,-110.4794694,-110.4217778,-110.3822889,-110.3796389,-110.3185028,-110.2588222,-110.2489667,-110.1889444,-110.0877222,-110.019575,-110.0018722,-109.9387056,-109.9208278,-109.8695167,-109.8415778,-109.8411944,-109.8354167,-109.8260111,-109.7313028,-109.6998945,-109.6959556,-109.6522667,-109.6520139,-109.6435694,-109.6421333,-109.5558139,-109.5323,-109.4605472,-109.4575,-109.4220556,-109.3911306,-109.3291889,-109.2533111,-109.2316944,-109.2305306,-109.1854028,-109.0653667,-108.9376111,-108.8927083,-108.8441056,-108.8315328,-108.75895,-108.7140528,-108.7083278,-108.7067611,-108.6956389,-108.6936861,-108.6877444,-108.6788306,-108.6606944,-108.6326531,-108.625986,-108.5701028,-108.5481028,-108.5418028,-108.5336528,-108.5326111,-108.4999056,-108.4680306,-108.415375,-108.3912194,-108.3887,-108.3628667,-108.3562389,-108.3200528,-108.2940944,-108.2903333,-108.1088722,-107.9328417,-107.9188889,-107.9184433,-107.8891639,-107.876375,-107.7492707,-107.6581492,-107.6154083,-107.5998917,-107.5821861,-107.567306,-107.5574694,-107.5199306,-107.4687917,-107.4401306,-107.39455,-107.3559,-107.3013833,-107.2187556,-107.1711389,-106.9903556,-106.9271083,-106.8398417,-106.8359444,-106.8223167,-106.8069472,-106.7713556,-106.700309,-106.6913028,-106.5698583,-106.5081667,-106.4925694,-106.4752306,-106.4573528,-106.3643139,-106.3578167,-106.3562583,-106.3422889,-106.2749444,-106.2550556,-106.2234333,-106.1534528,-105.8783778,-105.8600333,-105.8455222,-105.779996,-105.6969083,-105.6906083,-105.6802056,-105.5756444,-105.5330972,-105.4945278,-105.4027194,-105.3246528,-105.3103306,-105.3053528,-105.2128083,-105.1928167,-104.7610222,-104.7562111,-104.7184306,-104.7132667,-104.6295194,-104.5490333,-104.5396667,-104.5120861,-104.4776861,-104.4733,-104.455125,-104.2725889,-104.1775528,-104.1733528,-104.1554111],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Start date: 1990-10-01 <br>End date: 2022-10-01",null,null,null,["Yaak River near Troy MT","Lake Creek at Troy MT","Clark Fork bl Noxon Rapids Dam nr Noxon MT","Flower Creek near Libby MT","Kootenai River at Libby MT","Basin Creek near Yaak MT","Libby Wetland Site bl Schrieber Lake nr Libby, MT","Prospect Creek at Thompson Falls MT","Kootenai River bl Libby Dam nr Libby MT","Fisher River near Libby MT","Thompson River near Thompson Falls MT","St. Regis River near St. Regis, MT","Tobacco River near Eureka MT","Clark Fork at St. Regis MT","Tobacco River at Eureka, MT","Clark Fork near Plains MT","Mill Cr ab Bassoo Cr nr Niarada MT","Flathead River at Perma MT","Revais Cr bl West Fork nr Dixon MT","Stillwater River near Whitefish MT","Hallowat Creek abv Kletomus Creek, near Olney, MT","Stillwater River at Lawrence Park, at Kalispell","Ashley Creek at Kalispell MT","Jocko River at Dixon MT","Whitefish River nr mouth at Kalispell, MT","West Fork Bitterroot River nr Conner MT","Whitefish River near Kalispell MT","Flathead River near Polson MT","Flathead River near Kalispell, MT","Valley Creek near Arlee MT","Big Creek below Lookout Creek, near Apgar, MT","Flathead River at Columbia Falls MT","Bitterroot River near Darby MT","Clark Fork below Missoula MT","N F Flathead River nr Columbia Falls MT","Bitterroot River at Bell Crossing nr Victor MT","Creston Wetlands Flume near Creston MT","Flathead River near Bigfork MT","East Fork Bitterroot River nr Conner MT","Bitterroot River near Missoula MT","Laird Creek nr Sula, MT","Bitterroot River near Florence MT","S F Flathead River nr Columbia Falls MT","South Crow Creek near Ronan MT","M F Flathead River near West Glacier MT","Mission Creek ab reservoir nr St. Ignatius MT","Swan River near Bigfork, MT","Big Knife Creek near Arlee MT","Skalkaho Creek near Hamilton MT","Clark Fork above Missoula MT","South Fork Jocko River near Arlee MT","Clark Fork at Turah Bridge nr Bonner MT","West Fork Ruby Creek near Wisdom MT","Blackfoot River near Bonner MT","Grinnell C at G Glacier nr Many Glacier MT","Rock Creek near Clinton MT","Swiftcurrent Cr ab Swiftcurrent Lk at Many Glacier","Swan River near Condon MT","Swiftcurrent Creek at Many Glacier MT","Clark Fork near Clinton MT","S F Flathead R ab Twin C nr Hungry Horse MT","Swiftcurrent Creek at Sherburne MT","Middle Fork Rock Cr nr Philipsburg MT","Swamp Creek near Wisdom MT","Big Hole River near Jackson MT","Big Hole River bl Big Lake Cr at Wisdom MT","Big Hole River at Miner Creek nr Jackson MT","Big Hole River ab Spring Creek nr Jackson MT","St. Mary River near Babb MT","St. Mary Canal at intake near Babb MT","Clearwater River near Clearwater MT","St. Mary Canal at St. Mary Crossing near Babb MT","Marshall Cr Canal at Chor Ranch nr Philipsburg","Flint Cr ab Fred Burr Cr nr Philipsburg MT","Clark Fork near Drummond MT","Fred Burr Creek near Philipsburg MT","Big Hole River bl Mudd Cr nr Wisdom MT","Flint Creek near Philipsburg MT","Flint Creek near Southern Cross MT","Flint Creek at Maxville MT","Boulder Creek at Maxville MT","Flint Cr bl Douglas Cr nr Hall MT","Loranson Creek at Drummond MT","South Fork Milk River near Babb MT","Rodeo Grounds springs outflow at Drummond MT","Flint Creek near Drummond MT","Flint Creek at mouth at Drummond MT","NF Blackfoot R ab Dry Gulch nr Ovando MT","Big Hole River near Wise River MT","N F Milk River ab St. Mary canal nr Browning MT","Nevada Creek at mouth nr Helmville, MT","Cut Bank Creek near Browning MT","Blackfoot R ab Nevada Cr nr Helmville MT","Two Medicine River bl South Fork nr Browning MT","North Fork Blackfoot River Bel Lake Cr nr Ovando","Clark Fork at Goldcreek MT","Mill Creek nr Anaconda, MT","Warm Springs Creek near Anaconda MT","Rock Cr ab Salmon Cr nr Ovando MT","Lost Creek near Anaconda MT","Willow Creek nr Anaconda, MT","South Fork Sun River near Augusta MT","North Fork Sun River near Augusta MT","Willow Creek near Glen MT","Mill Creek at Opportunity, MT","Rock Cr bl Brownes Lake nr Glen MT","Two Medicine Canal near Browning MT","Willow Creek at Opportunity, MT","Silver Bow Creek at Opportunity MT","Badger Cr bl Four Horns Canal nr Browning MT","Little Blackfoot River near Garrison MT","Clark Fork ab Little Blackfoot R nr Garrison MT","Warm Springs Creek at Warm Springs MT","Silver Bow Creek at Warm Springs MT","Lost Creek near Galen, MT","Nevada Cr ab reservoir, nr Helmville, MT","Clark Fork near Galen MT","Beaverhead River at Barretts MT","Clark Fork at Deer Lodge MT","Big Hole River at Maiden Rock nr Divide MT","Big Hole River near Melrose MT","Birch Cr bl Heart Butte Road, nr Heart Butte, MT","Sun River bl Diversion Dam nr Augusta MT","Moose Creek above MacLean Creek, near Divide, MT","Beaverhead River at Dillon MT","Two Medicine River ab Badger Cr, nr Piegan, MT","Teton River bl South Fork nr Choteau MT","Cut Bank Cr ab Gillam Coulee, nr Sundance, MT","Upper Raffety Ditch near Glen MT","Silver Bow Cr bl Blacktail Cr, at Butte, MT","Silver Bow Cr ab wastewater plnt outflow, at Butte","Big Hole River near Glen MT","Silver Bow Creek at Montana Street, at Butte, MT","Blacktail Creek at Butte MT","Blacktail Creek above Grove Gulch, at Butte, MT","Silver Bow Cr ab Blacktail Cr at Butte MT","Blacktail C at Harrison Avenue at Butte MT","Beaverhead River near Twin Bridges MT","Red Rock R bl Lima Reservoir nr Monida MT","Sun River bl Willow Cr nr Augusta MT","Big Hole R bl Hamilton Ditch nr Twin Bridges, MT","Cut Bank Creek at Cut Bank MT","Beaverhead River at Twin Bridges, MT","Ruby River near Twin Bridges MT","Jefferson River near Twin Bridges MT","Birch Creek at Bullhead Bridge, nr Valier, MT","Grub Cr ab confluence w/unnamed trib, nr Rimini MT","Tenmile Creek near Rimini MT","Tenmile Cr ab Suzie Lode Adit at Rimini MT","Tenmile Ck ab city diversion, nr Rimini, MT","Beaver Cr bl City Diversion at Rimini MT","Tenmile Cr at Tenmile Wt Treatment Pl nr Rimini MT","Jefferson River at Parsons Bdg nr Silver Star, MT","Ruby River above reservoir near Alder, MT","Sevenmile C bl Granite C nr Helena MT","Ruby River below reservoir near Alder, MT","Dearborn River near Craig MT","Tenmile C at State Nursery Bridge nr Helena MT","Boulder River near Boulder MT","Tenmile Creek near Helena MT","Little Prickly Pear Cr at Wolf Cr MT","Tenmile Cr at Green Meadow Drive at Helena MT","Missouri River bl Holter Dam nr Wolf Cr MT","Tenmile Cr ab Prickley Pear Cr nr Helena","Prickly Pear Creek near Clancy MT","Sun River at Simms MT","Marias River near Shelby MT","Missouri River bl Hauser Dam near Helena MT","Odell Cr ab Taft Ranch nr Lakeview MT","Madison River near Cameron MT","Willow Creek near Harrison MT","Missouri River at Cascade MT","Muddy Creek near Vaughn MT","Madison River bl Ennis Lake nr McAllister MT","Madison River ab powerplant nr McAllister MT","Red Rock Cr ab Lakes, nr Lakeview, MT","Jefferson River near Three Forks MT","Jack Creek near Ennis MT","Madison River at Kirby Ranch nr Cameron MT","Teton River near Dutton MT","Muddy Creek at Vaughn MT","Missouri River near Townsend MT","Sun River near Vaughn MT","Gallatin River at Logan MT","Missouri River at Toston MT","Lake Creek near Power MT","Missouri River near Ulm MT","Smith River near Eden MT","Willow Creek near Galata, MT","Madison River bl Hebgen Lake nr Grayling MT","Gallatin River near Gallatin Gateway, MT","Gallatin River above Deer Creek, near Big Sky, MT","Camas C nr Mouth nr White Sulphur Springs MT","Smith River bl Eagle Cr nr Fort Logan MT","Camas Cr at mouth, nr White Sulphur Springs, MT","Number Five Coulee bl Giffen Spring nr Stockett","Smith River bl Sheep Cr nr Fort Logan MT","Smith River near Ft Logan MT","Sand Coulee at Sand Coulee MT","Cottonwood Creek near Stockett MT","Sand Coulee Ck ab Cottonwood Cr at Centerville","Marias River near Chester MT","Hyalite C at Hyalite R S nr Bozeman MT","East Gallatin R bl Bridger C nr Bozeman MT","Madison River near West Yellowstone, MT","E Gallatin R ab Water Reclamation Fa nr Bozeman MT","Missouri River near Great Falls MT","Smith River bl Newlan Cr nr White Sulphur Springs","NF Smith R ab conf nr White Sulphur Springs","Belt Creek near Monarch MT","Anaconda Drain at Belt MT","Big Otter Creek near Belt MT","Yellowstone River at Corwin Springs MT","Sheep Creek near Neihart MT","Gardner River near Mammoth, YNP","Missouri River at Fort Benton MT","Marias River near Loma MT","Yellowstone River near Livingston, MT","Shields River ab Smith Cr, nr Wilsall, MT","Teton River at Loma MT","Shields River nr Livingston MT","Milk River at Eastern Crossing of Int Bndry","South Fork Musselshell R ab Martinsdale MT","Dugout Creek at mouth, nr Wilsall, MT","South Fork Musselshell River at Martinsdale, MT","Missouri River at Virgelle MT","Musselshell River nr Martinsdale, MT","Judith River above Carr Creek near Utica MT","East Boulder River bl Dry Fork Cr nr Mcleod, MT","Boxelder Creek at Box Elder, MT","Soda Butte Cr at Park Bndry at Silver Gate","Boulder River at Big Timber MT","Big Sandy Cr ab Spring Coulee, nr Laredo, MT","Stillwater River ab Nye Cr nr Nye MT","Big Sandy Creek near Havre MT","Musselshell River at Harlowton MT","Boxelder Creek near Rocky Boy, MT","Big Sandy Cr at Res Bndry nr Rocky Boy MT","West Rosebud Creek near Roscoe MT","W Rosebud Cr at Emerald Lk Campground nr Roscoe","Milk River at Havre MT","Beaver Cr at Res Bndry nr Rocky Boy MT","Judith River nr mouth, nr Winifred MT","Beaver Creek ab Elk Creek, nr Rocky Boy, MT","West Fork Beaver Creek nr Rocky Boy, MT","Musselshell River nr Shawmut MT","Little Box Elder Cr at Mouth nr Havre MT","Musselshell River ab Mud Cr nr Shawmut MT","Big Spring Cr at R&amp;B Trading Post nr Lewistown MT","Stillwater River near Absarokee, MT","Clear Creek near Chinook MT","Rock Creek near Red Lodge MT","Red Lodge Cr ab Cooney Re nr Boyd MT","Battle Creek near Chinook MT","Willow Creek near Boyd MT","Red Lodge Cr bl Cooney Reservoir nr Boyd MT","Clarks Fork Yellowstone River nr Belfry MT","Musselshell River ab Big Coulee Creek at Lavina MT","Musselshell River near Lavina MT","Clarks Fork Yellowstone River at Edgar MT","White Horse Canal near Silesia MT","Milk River near Harlem MT","Peoples Creek near Hays MT","Fifteenmile Cr Tributary nr Harlem MT","Duval Creek near Landusky MT","Armells Creek nr Landusky MT","Willow Cr ab LMGA Reservoir nr Roundup MT","Missouri River near Landusky MT","Willow Cr at U.S. canal nr Roundup MT","Little Peoples Creek near Hays MT","25N24E09DDCB01 KING CREEK ABOVE BEAVER PONDS","25N24E15BBAA01  KING CR BL BEAVER PONDS","Musselshell River near Roundup MT","Rock Creek near Landusky MT","Halfbreed Creek near Klein MT","Pryor Creek at Pryor MT","Lodge Pole Creek at Lodge Pole MT","North Fork Crooked Cr trib nr Shepherd MT","Yellowstone River at Billings MT","Willow Coulee near Dodson MT","Beaver Creek near Zortman MT","Kuhr Coulee Tributary near Dodson MT","Little Warm C at Reservation Bndry nr Zortman MT","Peoples Cr bl Kuhr Coulee nr Dodson MT","Little Warm Cr Tributary nr Lodge Pole MT","Milk River near Dodson MT","Pryor Creek nr Huntley MT","Musselshell River at Musselshell MT","Flatwillow Creek near Mosby MT","Bighorn R bl Yellowtail Afterbay Dam nr St. Xavier","Big Horn Canal near St. Xavier MT","Musselshell River at Mosby MT","Milk River at Malta MT","Bighorn River at bridge, at St. Xavier, MT","Bighorn River at Two Leggins Bridge, near Hardin","Little Bighorn River at State Line nr Wyola MT","Lodge Grass Cr ab Willow Cr diversion, nr Wyola MT","Beaver Cr bl Guston Coulee nr Saco MT","Agency Canal Tailwaste near Hardin MT","Little Bighorn River near Hardin MT","Milk River at Cree Crossing nr Saco MT","Bighorn River ab Tullock Cr nr Bighorn MT","Little Bighorn River near Wyola MT","Little Bighorn R bl Pass Cr nr Wyola MT","Pass Creek near Wyola MT","Owl Creek near Lodge Grass MT","Milk River at Juneberg Bridge nr Saco MT","Beaver Creek near Hinsdale MT","Rosebud C at Reservation Bndry nr Kirby MT","Hell Creek near Jordan MT","Rock Creek bl Horse Creek nr int'l boundary","Tongue River at State Line nr Decker MT","Milk River at Tampico MT","Armells Creek near Forsyth MT","Tongue River at Tongue R Dam nr Decker MT","Rosebud C Bel Lame Deer C nr Lame Deer MT","Yellowstone River at Forsyth MT","Rosebud Creek near Colstrip MT","Hanging Woman Creek near Birney MT","Rosebud Creek at Hwy 447 bridge nr Rosebud, MT","Rosebud Creek at mouth near Rosebud MT","Tongue R at Birney Day School Br nr Birney MT","Milk River at Nashua MT","Big Dry Creek near Van Norman MT","Missouri River below Fort Peck Dam MT","Porcupine Creek at Nashua MT","Tongue River at Ashland, MT","Otter Creek at Ashland MT","Tongue R bl Brandenberg bridge nr Ashland MT","Nelson Creek near Van Norman MT","Powder River at Moorhead MT","Yellowstone River at Miles City, MT","Tongue River at Miles City, MT","Tongue R ab T &amp; Y Div Dam nr Miles City, MT","Poplar River at international boundary","Pumpkin Creek near Miles City MT","Wolf Creek near Wolf Point MT","Redwater River at Circle MT","Missouri River near Wolf Point MT","Cow Creek Tributary near Vida MT","Powder River at Broadus MT","Cherry Creek near Terry MT","Powder River near Locate MT","Little Powder River near Broadus MT","Redwater River near Vida MT","Poplar River near Poplar MT","O'Fallon Creek near Ismay MT","Wolf Creek near Hammond MT","Yellowstone River at Glendive, MT","Cains Coulee at Glendive MT","Big Muddy Creek nr mouth nr Culbertson MT","Big Muddy Cr diversion canal nr Medicine Lake MT","Yellowstone River Fish Bypass Channel nr Intake MT","Big Muddy Creek near Antelope MT","Hawksnest Creek Tributary near Albion MT","Missouri River near Culbertson MT","Marron Creek trib near Plentywood MT","Sand Creek near Dagmar MT","Lake Creek near Dagmar MT","Cottonwood Creek near Dagmar MT","Yellowstone River near Sidney MT"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[44.57740556,48.9902861],"lng":[-115.9701583,-104.1554111]}},"evals":[],"jsHooks":[]}</script>
<p>Let’s change the popup to be the site_no.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="dataretrieval.html#cb79-1" tabindex="-1"></a>mt_gauge_map <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb79-2"><a href="dataretrieval.html#cb79-2" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(<span class="st">&quot;OpenStreetMap&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb79-3"><a href="dataretrieval.html#cb79-3" tabindex="-1"></a>  <span class="fu">addAwesomeMarkers</span>(<span class="at">data =</span> stream_gauges, <span class="at">lat =</span> <span class="sc">~</span>dec_lat_va, <span class="at">lng =</span> <span class="sc">~</span>dec_long_va, <span class="at">label =</span> <span class="sc">~</span>station_nm, </span>
<span id="cb79-4"><a href="dataretrieval.html#cb79-4" tabindex="-1"></a>                    <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">&quot;Site&quot;</span>, site_no)) </span></code></pre></div>
<p><strong>Challenge</strong>: change the code that generates the “stream_gauges” object to generate an object called “gallatin” that only includes the gauges within Gallatin County and map them. Investigate the map and pay particular attention to 06048650 and 06048700. What is going on there?</p>
<p>Let’s explore some of dataRetrieval capabilities using two local gauging sites. Let’s work with 1. A USGS gauge on the Gallatin River near Gallatin Gateway. The gague number is 06043500. And another gauge near the reservoir at Hyalite, gauge number 06050000.</p>
</div>
<div id="first-lets-map-these-sites." class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> First, let’s map these sites.<a href="dataretrieval.html#first-lets-map-these-sites." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="dataretrieval.html#cb80-1" tabindex="-1"></a><span class="co">#important: note the site number gets input as a character</span></span>
<span id="cb80-2"><a href="dataretrieval.html#cb80-2" tabindex="-1"></a>site <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;06043500&quot;</span>, <span class="st">&quot;06050000&quot;</span>)</span>
<span id="cb80-3"><a href="dataretrieval.html#cb80-3" tabindex="-1"></a></span>
<span id="cb80-4"><a href="dataretrieval.html#cb80-4" tabindex="-1"></a></span>
<span id="cb80-5"><a href="dataretrieval.html#cb80-5" tabindex="-1"></a><span class="co">#Information about the sites</span></span>
<span id="cb80-6"><a href="dataretrieval.html#cb80-6" tabindex="-1"></a>site_info <span class="ot">&lt;-</span> <span class="fu">readNWISsite</span>(site)</span>
<span id="cb80-7"><a href="dataretrieval.html#cb80-7" tabindex="-1"></a></span>
<span id="cb80-8"><a href="dataretrieval.html#cb80-8" tabindex="-1"></a></span>
<span id="cb80-9"><a href="dataretrieval.html#cb80-9" tabindex="-1"></a><span class="co"># plot the gauge sites with a street map background basemap</span></span>
<span id="cb80-10"><a href="dataretrieval.html#cb80-10" tabindex="-1"></a>street_map <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb80-11"><a href="dataretrieval.html#cb80-11" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(<span class="st">&quot;OpenStreetMap&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-12"><a href="dataretrieval.html#cb80-12" tabindex="-1"></a>  <span class="fu">addAwesomeMarkers</span>(<span class="at">data =</span> site_info, <span class="at">lat =</span> <span class="sc">~</span>dec_lat_va, <span class="at">lng =</span> <span class="sc">~</span>dec_long_va, <span class="at">label =</span> <span class="sc">~</span>station_nm, </span>
<span id="cb80-13"><a href="dataretrieval.html#cb80-13" tabindex="-1"></a>                    <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">&quot;Site:&quot;</span>, site_no)) </span>
<span id="cb80-14"><a href="dataretrieval.html#cb80-14" tabindex="-1"></a></span>
<span id="cb80-15"><a href="dataretrieval.html#cb80-15" tabindex="-1"></a>street_map</span></code></pre></div>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-37f47f4475080b2707e0" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-37f47f4475080b2707e0">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["OpenStreetMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addAwesomeMarkers","args":[[45.4973,45.56332778],[-111.2707083,-111.0718889],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["Site: 06043500","Site: 06050000"],null,null,null,["Gallatin River near Gallatin Gateway, MT","Hyalite C at Hyalite R S nr Bozeman MT"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[45.4973,45.56332778],"lng":[-111.2707083,-111.0718889]}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="dataretrieval.html#cb81-1" tabindex="-1"></a><span class="co"># or with imagery</span></span>
<span id="cb81-2"><a href="dataretrieval.html#cb81-2" tabindex="-1"></a>esri_map <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb81-3"><a href="dataretrieval.html#cb81-3" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(<span class="st">&quot;Esri.WorldImagery&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb81-4"><a href="dataretrieval.html#cb81-4" tabindex="-1"></a>  <span class="fu">addAwesomeMarkers</span>(<span class="at">data =</span> site_info, <span class="at">lat =</span> <span class="sc">~</span>dec_lat_va, <span class="at">lng =</span> <span class="sc">~</span>dec_long_va, <span class="at">label =</span> <span class="sc">~</span>station_nm, </span>
<span id="cb81-5"><a href="dataretrieval.html#cb81-5" tabindex="-1"></a>                    <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">&quot;Site:&quot;</span>, site_no)) </span>
<span id="cb81-6"><a href="dataretrieval.html#cb81-6" tabindex="-1"></a>  </span>
<span id="cb81-7"><a href="dataretrieval.html#cb81-7" tabindex="-1"></a>esri_map</span></code></pre></div>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b58896696c4d962a5e52" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-b58896696c4d962a5e52">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Esri.WorldImagery",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addAwesomeMarkers","args":[[45.4973,45.56332778],[-111.2707083,-111.0718889],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["Site: 06043500","Site: 06050000"],null,null,null,["Gallatin River near Gallatin Gateway, MT","Hyalite C at Hyalite R S nr Bozeman MT"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[45.4973,45.56332778],"lng":[-111.2707083,-111.0718889]}},"evals":[],"jsHooks":[]}</script>
<p>Now we have looked at where the sites are located. Now let’ see what data are available with whatNWISdata().</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="dataretrieval.html#cb82-1" tabindex="-1"></a><span class="co">#What data are available for the sites?</span></span>
<span id="cb82-2"><a href="dataretrieval.html#cb82-2" tabindex="-1"></a><span class="co"># service = dv means give us the daily averages. </span></span>
<span id="cb82-3"><a href="dataretrieval.html#cb82-3" tabindex="-1"></a>data_available <span class="ot">&lt;-</span> <span class="fu">whatNWISdata</span>(<span class="at">siteNumber =</span> site, <span class="at">service =</span> <span class="st">&quot;dv&quot;</span>, <span class="at">statCd =</span> <span class="st">&quot;00003&quot;</span>)</span></code></pre></div>
</div>
<div id="joins" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Joins<a href="dataretrieval.html#joins" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When we look at what whatNWISdata returns, we see it gives us parameter codes (param_cd), but doesn’t tell us what they mean. This is a common attribute of databases: you use a common identifier but then have the full information in a lookup file. In this case, the look-up information telling us what the parameter codes mean is in “parameterCdFile” which loads with the dataRetrieval package.</p>
<p>So, you could look at that and see what the parameters mean. In the console type “view(parameterCdFile)”. That doesn’t seem very practical. There are over 24,000 rows!</p>
<p>Instead let’s have R do it and add a column that tells us what the parameters mean. Enter JOINS!</p>
<p>Joins allow us to combine the data from two different data frames (dfs) that have a column in common. At its most basic, a join looks for a matching row with the same key in both dfs (for example, a USGS gauge number) and then combines the rows. So now you have all the data from both dfs, matched on the key.</p>
<p>But you have to make some decisions: what if a key value exists in one df but not the other? Do you just drop that observation? Do you add an NA? Let’s look at the different options.</p>
<p>Take for example the two dfs, FlowTable and SizeTable. The SiteName values are the key values and the MeanFlow and WSsize values are the data.</p>
<div class="float">
<img src="images/joinsetup.png" title="Join setup" width="400" alt="Join Setup" />
<div class="figcaption">Join Setup</div>
</div>
<p>Note River1 and River2 match up, but River3 and River5 only exist in one df or the other.</p>
<p>The first way to deal with this is an <strong>INNER JOIN: inner_join()</strong> In an inner join, you only keep records that match. So the rows for River3 and River5 will be dropped because there is no corresponding data in the other df. See below:</p>
<div class="float">
<img src="images/innerjoin.png" title="Inner Join" alt="Inner Join" />
<div class="figcaption">Inner Join</div>
</div>
<p>But what if you don’t want to lose the values in one or the other or both?!</p>
<p>For instance, let’s say you have a bunch of discharge data for a stream, and then chemistry grab samples at a weekly or monthly timestep. You want to join the chemistry to the discharge based on the dates and times they were taken. But when you do this, you don’t want to delete all the discharge data where there is no chemistry! We need another option. Enter OUTER JOINS</p>
<p><strong>LEFT JOIN, left_join():</strong> Preserves all values from the LEFT df, and pastes on the matching ones from the right. This creates NAs where there is a value on the left but not the right. (this is what you’d want to do in the discharge - chemistry example above)</p>
<div class="float">
<img src="images/leftjoin1.png" title="Left Join" alt="Left Join" />
<div class="figcaption">Left Join</div>
</div>
<p><strong>RIGHT JOIN, right_join():</strong> Preserves all values from the RIGHT df, and pastes on the matching ones from the left. This creates NAs where there is a value on the right but not the left.</p>
<div class="float">
<img src="images/rightjoin.png" title="Right Join" alt="Right Join" />
<div class="figcaption">Right Join</div>
</div>
<p><strong>FULL JOIN, full_join():</strong> KEEP EVERYTHING! The hoarder of the joins. No matching record on the left? create an NA on the right! No matching value on the right? Create an NA on the left! NAs for everyone!</p>
<div class="float">
<img src="images/fulljoin.png" title="Full Join" alt="Full Join" />
<div class="figcaption">Full Join</div>
</div>
<p>When you do this in R, you use the functions identified in the descriptions with the following syntax (see example below):</p>
<p><strong>if the column is named the same in both data sets</strong> &gt; xxx_join(left_tibble, right_tibble, by = “key_column”)**</p>
<p><strong>if the column is named differently in both data sets</strong> &gt; xxx_join(left_tibble, right_tibble, by = c(“left_key” = “right_key”)</p>
<div class="float">
<img src="images/leftjoin2.png" title="Left Join with differing column names" alt="Left Join Differing Col Names" />
<div class="figcaption">Left Join Differing Col Names</div>
</div>
<p>Note in both of the above, when you specify which column to use as “by” you have to put it in quotes.</p>
</div>
<div id="join-practice-example" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Join practice example<a href="dataretrieval.html#join-practice-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the chunk below write code to add information about the parameters in data_available by joining it with the parameterCdFile. The column with the parameter codes is called parm_cd in data_available and parameter_cd in parameterCdFile</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="dataretrieval.html#cb83-1" tabindex="-1"></a>data_available_cd <span class="ot">&lt;-</span> <span class="fu">left_join</span>(data_available, parameterCdFile, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;parm_cd&quot;</span> <span class="ot">=</span> <span class="st">&quot;parameter_cd&quot;</span>))</span>
<span id="cb83-2"><a href="dataretrieval.html#cb83-2" tabindex="-1"></a></span>
<span id="cb83-3"><a href="dataretrieval.html#cb83-3" tabindex="-1"></a></span>
<span id="cb83-4"><a href="dataretrieval.html#cb83-4" tabindex="-1"></a><span class="co"># that made a lot of columns, write code to clean that up and keep only relevant columns.</span></span>
<span id="cb83-5"><a href="dataretrieval.html#cb83-5" tabindex="-1"></a>data_avail_clean <span class="ot">&lt;-</span> data_available_cd <span class="sc">%&gt;%</span> <span class="fu">select</span>(site_no, </span>
<span id="cb83-6"><a href="dataretrieval.html#cb83-6" tabindex="-1"></a>                                           station_nm,</span>
<span id="cb83-7"><a href="dataretrieval.html#cb83-7" tabindex="-1"></a>                                           parm_cd, </span>
<span id="cb83-8"><a href="dataretrieval.html#cb83-8" tabindex="-1"></a>                                           srsname, <span class="co">#substance registry services</span></span>
<span id="cb83-9"><a href="dataretrieval.html#cb83-9" tabindex="-1"></a>                                           parameter_units,</span>
<span id="cb83-10"><a href="dataretrieval.html#cb83-10" tabindex="-1"></a>                                           begin_date, </span>
<span id="cb83-11"><a href="dataretrieval.html#cb83-11" tabindex="-1"></a>                                           end_date)</span></code></pre></div>
<p><strong>Question</strong>: in data_avail_clean why are there two rows for 06043500?</p>
</div>
<div id="now-we-know-what-is-available-so-lets-download-some-data-from-the-gallatin-site-using-readnwisdata." class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Now we know what is available so let’s download some data from the Gallatin site using “readNWISdata”.<a href="dataretrieval.html#now-we-know-what-is-available-so-lets-download-some-data-from-the-gallatin-site-using-readnwisdata." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="dataretrieval.html#cb84-1" tabindex="-1"></a><span class="co"># first let set some parameters. What do each of these do? </span></span>
<span id="cb84-2"><a href="dataretrieval.html#cb84-2" tabindex="-1"></a>gal_q_site <span class="ot">&lt;-</span> data_avail_clean<span class="sc">$</span>site_no[<span class="dv">2</span>]</span>
<span id="cb84-3"><a href="dataretrieval.html#cb84-3" tabindex="-1"></a>gal_q_param <span class="ot">&lt;-</span> data_avail_clean<span class="sc">$</span>parm_cd[<span class="dv">2</span>]</span>
<span id="cb84-4"><a href="dataretrieval.html#cb84-4" tabindex="-1"></a>gal_q_start <span class="ot">&lt;-</span> data_avail_clean<span class="sc">$</span>begin_date[<span class="dv">2</span>]</span>
<span id="cb84-5"><a href="dataretrieval.html#cb84-5" tabindex="-1"></a>gal_q_end <span class="ot">&lt;-</span> data_avail_clean<span class="sc">$</span>end_date[<span class="dv">2</span>]</span>
<span id="cb84-6"><a href="dataretrieval.html#cb84-6" tabindex="-1"></a></span>
<span id="cb84-7"><a href="dataretrieval.html#cb84-7" tabindex="-1"></a></span>
<span id="cb84-8"><a href="dataretrieval.html#cb84-8" tabindex="-1"></a>gal_q <span class="ot">&lt;-</span> <span class="fu">readNWISdata</span>(<span class="at">sites =</span> gal_q_site, <span class="at">parameterCd =</span> gal_q_param, <span class="at">service =</span><span class="st">&quot;dv&quot;</span>, <span class="at">startDate =</span> gal_q_start, <span class="at">endDate =</span> gal_q_end) </span>
<span id="cb84-9"><a href="dataretrieval.html#cb84-9" tabindex="-1"></a></span>
<span id="cb84-10"><a href="dataretrieval.html#cb84-10" tabindex="-1"></a></span>
<span id="cb84-11"><a href="dataretrieval.html#cb84-11" tabindex="-1"></a></span>
<span id="cb84-12"><a href="dataretrieval.html#cb84-12" tabindex="-1"></a><span class="co"># Those column names are awful. Let&#39;s try that again and pipe into &quot;renameNWISColumns()&quot;</span></span>
<span id="cb84-13"><a href="dataretrieval.html#cb84-13" tabindex="-1"></a>gal_q <span class="ot">&lt;-</span> <span class="fu">readNWISdata</span>(<span class="at">sites =</span> gal_q_site, <span class="at">parameterCd =</span> gal_q_param, <span class="at">service =</span><span class="st">&quot;dv&quot;</span>, <span class="at">startDate =</span> gal_q_start, <span class="at">endDate =</span> gal_q_end) <span class="sc">%&gt;%</span> </span>
<span id="cb84-14"><a href="dataretrieval.html#cb84-14" tabindex="-1"></a>  <span class="fu">renameNWISColumns</span>()</span></code></pre></div>
<p>But is the Q data continuous for the entire period? The easiest way to find out is to make a plot. Make a ggplot with Q on the y and date on the x.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="dataretrieval.html#cb85-1" tabindex="-1"></a>gal_q <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href="dataretrieval.html#cb85-2" tabindex="-1"></a> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dateTime, <span class="at">y =</span> Flow)) <span class="sc">+</span></span>
<span id="cb85-3"><a href="dataretrieval.html#cb85-3" tabindex="-1"></a> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdown.Rprog_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="dataretrieval.html#cb86-1" tabindex="-1"></a><span class="co"># Another way to explore this data is to use plotly, which creates an interactive graph. </span></span>
<span id="cb86-2"><a href="dataretrieval.html#cb86-2" tabindex="-1"></a><span class="co">#install.packages</span></span>
<span id="cb86-3"><a href="dataretrieval.html#cb86-3" tabindex="-1"></a><span class="co">#library(plotly)</span></span>
<span id="cb86-4"><a href="dataretrieval.html#cb86-4" tabindex="-1"></a><span class="co"># I&#39;m commenting this section out becuase it bogs down the knitting. </span></span>
<span id="cb86-5"><a href="dataretrieval.html#cb86-5" tabindex="-1"></a><span class="co">#ggplotly(gal_q %&gt;% </span></span>
<span id="cb86-6"><a href="dataretrieval.html#cb86-6" tabindex="-1"></a>  <span class="co">#ggplot(aes(x = dateTime, y = Flow)) +</span></span>
<span id="cb86-7"><a href="dataretrieval.html#cb86-7" tabindex="-1"></a>  <span class="co">#geom_point()) # as an fyi, plotly is slow with large data sets. So you might want to comment this section out after you do your exploration. </span></span>
<span id="cb86-8"><a href="dataretrieval.html#cb86-8" tabindex="-1"></a></span>
<span id="cb86-9"><a href="dataretrieval.html#cb86-9" tabindex="-1"></a><span class="co"># We&#39;ve identified some gaps. Now let&#39;s filter to everything after 1990</span></span>
<span id="cb86-10"><a href="dataretrieval.html#cb86-10" tabindex="-1"></a></span>
<span id="cb86-11"><a href="dataretrieval.html#cb86-11" tabindex="-1"></a>gal_q <span class="ot">&lt;-</span> gal_q <span class="sc">%&gt;%</span> </span>
<span id="cb86-12"><a href="dataretrieval.html#cb86-12" tabindex="-1"></a>  <span class="fu">filter</span>(dateTime <span class="sc">&gt;</span> <span class="st">&quot;1990-09-30&quot;</span>)</span></code></pre></div>
<p>Let’s now plot that more recent (1990 - now) data.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="dataretrieval.html#cb87-1" tabindex="-1"></a>gal_q <span class="sc">%&gt;%</span> </span>
<span id="cb87-2"><a href="dataretrieval.html#cb87-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dateTime, <span class="at">y =</span> Flow)) <span class="sc">+</span></span>
<span id="cb87-3"><a href="dataretrieval.html#cb87-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="bookdown.Rprog_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<p>That looks better!</p>
<p><strong>Challenge</strong> follow the steps from above to download and plot temperature data for the Gallatin River site (06043500) from begin_date to end_date. call the data frame gal_t.</p>
<p><strong>Challenge</strong> use join to create a dataframe called gal_t_q that joins gal_t and gal_q and keeps only Q data when there is T data. Then plot both Q and T and stack the plots.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="dataretrieval.html#cb88-1" tabindex="-1"></a><span class="co">#let&#39;s clean that up!</span></span></code></pre></div>
<p><strong>Challenge</strong> Using gal_t_q, plot Q in cubic meters per second on x and T in Celsius on Y, color by date, add labels to axes, and select a theme.</p>
<p>Ok. So above was one way that we could download some data. Let’s explore another approach.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="dataretrieval.html#cb89-1" tabindex="-1"></a><span class="co"># Let&#39;s download some dta for the Hyalite Creek and Gallatin Gateway gauges. Let&#39;s also use the parameters that we have already defined. Things like servie_cd, param_cd, site, etc.</span></span>
<span id="cb89-2"><a href="dataretrieval.html#cb89-2" tabindex="-1"></a></span>
<span id="cb89-3"><a href="dataretrieval.html#cb89-3" tabindex="-1"></a>hy_gal <span class="ot">&lt;-</span> <span class="fu">readNWISdata</span>(<span class="at">site =</span> site, <span class="at">service =</span> service_cd, <span class="at">parameterCd =</span> param_cd, <span class="at">startDate =</span> start, <span class="at">endDate =</span> end) <span class="sc">%&gt;%</span> </span>
<span id="cb89-4"><a href="dataretrieval.html#cb89-4" tabindex="-1"></a>  <span class="fu">renameNWISColumns</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb89-5"><a href="dataretrieval.html#cb89-5" tabindex="-1"></a>  <span class="fu">select</span>(site_no, <span class="at">date =</span> dateTime, <span class="at">flow =</span> Flow)</span>
<span id="cb89-6"><a href="dataretrieval.html#cb89-6" tabindex="-1"></a></span>
<span id="cb89-7"><a href="dataretrieval.html#cb89-7" tabindex="-1"></a></span>
<span id="cb89-8"><a href="dataretrieval.html#cb89-8" tabindex="-1"></a><span class="co"># now let&#39;s do a join so that we have both the site number (site_no) and the station name in the df.</span></span>
<span id="cb89-9"><a href="dataretrieval.html#cb89-9" tabindex="-1"></a>hy_gal_names <span class="ot">&lt;-</span> <span class="fu">left_join</span>(hy_gal, data_avail_clean, <span class="at">by =</span> <span class="st">&quot;site_no&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-10"><a href="dataretrieval.html#cb89-10" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">station =</span> station_nm, site_no, date, flow)</span></code></pre></div>
<p>Now let’s make a plot of Q at the Gallatin and Hyalite gauges to do an assessment (EDA) of the data. What is your observation?</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="dataretrieval.html#cb90-1" tabindex="-1"></a>hy_gal_names <span class="sc">%&gt;%</span> </span>
<span id="cb90-2"><a href="dataretrieval.html#cb90-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> flow, <span class="at">color =</span> station)) <span class="sc">+</span></span>
<span id="cb90-3"><a href="dataretrieval.html#cb90-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb90-4"><a href="dataretrieval.html#cb90-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Date&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Q (cfs)&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Gauge&quot;</span>) <span class="sc">+</span></span>
<span id="cb90-5"><a href="dataretrieval.html#cb90-5" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() </span></code></pre></div>
<p><img src="bookdown.Rprog_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="dataretrieval.html#cb91-1" tabindex="-1"></a><span class="co"># We can log the y axis to zoom in on the low values a bit. </span></span>
<span id="cb91-2"><a href="dataretrieval.html#cb91-2" tabindex="-1"></a>hy_gal_names <span class="sc">%&gt;%</span> </span>
<span id="cb91-3"><a href="dataretrieval.html#cb91-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> flow, <span class="at">color =</span> station)) <span class="sc">+</span></span>
<span id="cb91-4"><a href="dataretrieval.html#cb91-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb91-5"><a href="dataretrieval.html#cb91-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Date&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Q (cfs)&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Gauge&quot;</span>) <span class="sc">+</span></span>
<span id="cb91-6"><a href="dataretrieval.html#cb91-6" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb91-7"><a href="dataretrieval.html#cb91-7" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span></code></pre></div>
<p><img src="bookdown.Rprog_files/figure-html/unnamed-chunk-74-2.png" width="672" /></p>
<p><strong>Challenge</strong> Download Q data for all of the sites in the gallatin df. Rename columns using renameNWIScolumns and call this df gallatin_q. Join gallatin and gallatin_q so that you have a df that includes the station names. Plot Q and color by station name.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lab-1-data-vis-wrangling-and-programming-12-pts.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lab-2-dataretrieval-and-area-normalized-flows-20-pts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tpcovino/ensc_445_545_bookdown/edit/master/05_data_retrieval_partial.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/tpcovino/ensc_445_545_bookdown/blob/master/05_data_retrieval_partial.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
